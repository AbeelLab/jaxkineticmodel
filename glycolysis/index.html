<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Custom models - jaxkineticmodel documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Custom models";
        var mkdocs_page_input_path = "glycolysis.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> jaxkineticmodel documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../building_models/">Building and simulating models</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../SBML/">Loading SBML models</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../training_models/">Training models</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../simulated-DBTL/">Simulated-DBTL</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Custom models</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#rate-laws">Rate laws</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#setting-up-the-ode-system">Setting up the ODE system</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#cubic-spline-boundary-condition">Cubic spline boundary condition</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#parameters-and-initial-conditions">Parameters and initial conditions</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#exporting-the-model">Exporting the model</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#references">References</a>
    </li>
    </ul>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">jaxkineticmodel documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Custom models</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="custom-ode-models">Custom ODE models</h1>
<p>Not all kinetic model can be drafted only from stoichiometry. There are empirical laws that might influence 
There are many empirical laws that might influence reactions in the system of ODEs. 
Below, we present a reimplemented version of a glycolysis model<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>
in Jax. We wil note down specific modeling choices that can be used to incorporate 
non-stoichiometric modifications. This output of this script can be found
<a href="https://github.com/AbeelLab/jaxkineticmodel/blob/main/models/manual_implementations/sbml_export/glycolysis_feastfamine_pulse1.xml">SBML model</a></p>
<h2 id="rate-laws">Rate laws</h2>
<p>We start by importing relevant modules from <code>jaxkineticmodel</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="sd">&quot;&quot;&quot;Implementation of the glycolysis model from</span>
<span class="sd">Lao-Martil, D., Schmitz, J. P., Teusink, B., &amp; van Riel, N. A. (2023).</span>
<span class="sd">Elucidating yeast glycolytic dynamics at steady state growth and glucose pulses</span>
<span class="sd">through kinetic metabolic modeling. Metabolic Engineering, 77, 128-142. Stoichiometry is</span>
<span class="sd">changed according to the paper.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">jax</span>
<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">sympy</span>

<span class="kn">from</span> <span class="nn">jaxkineticmodel.building_models</span> <span class="kn">import</span> <span class="n">JaxKineticModelBuild</span> <span class="k">as</span> <span class="n">jkm</span>
<span class="kn">from</span> <span class="nn">jaxkineticmodel.kinetic_mechanisms</span> <span class="kn">import</span> <span class="n">JaxKineticMechanisms</span> <span class="k">as</span> <span class="n">jm</span>
<span class="kn">from</span> <span class="nn">jaxkineticmodel.kinetic_mechanisms</span> <span class="kn">import</span> <span class="n">JaxKineticMechanismsCustom</span> <span class="k">as</span> <span class="n">jcm</span>
<span class="kn">from</span> <span class="nn">jaxkineticmodel.kinetic_mechanisms</span> <span class="kn">import</span> <span class="n">JaxKineticModifiers</span> <span class="k">as</span> <span class="n">modifier</span>
<span class="kn">from</span> <span class="nn">jaxkineticmodel.load_sbml.export_sbml</span> <span class="kn">import</span> <span class="n">SBMLExporter</span>
</code></pre></div>

<p>We define all reactions that are in the glycolysis model by using the <code>Reaction</code> object.
This requires setting a name, species that are in the stoichiometry, the stoichiometry itself, 
and the mechanism used to compute. Note that metabolites (species) that only 'modify' a reaction,
that is, they are involved in the reaction but not consumed or produced, should
also be included in species list and stoichiometry as 0. </p>
<div class="codehilite"><pre><span></span><code><span class="n">v_glt</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_GLT&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ECglucose&#39;</span><span class="p">,</span> <span class="s1">&#39;ICglucose&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jm</span><span class="o">.</span><span class="n">Jax_Facilitated_Diffusion</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ECglucose&quot;</span><span class="p">,</span> <span class="n">product</span><span class="o">=</span><span class="s2">&quot;ICglucose&quot;</span><span class="p">,</span>
                                           <span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_GLT_VmGLT&quot;</span><span class="p">,</span> <span class="n">km_internal</span><span class="o">=</span><span class="s2">&quot;p_GLT_KmGLTGLCi&quot;</span><span class="p">,</span>
                                           <span class="n">km_external</span><span class="o">=</span><span class="s2">&quot;p_GLT_KmGLTGLCo&quot;</span><span class="p">,</span> <span class="p">))</span>

<span class="n">v_hxk</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_HXK&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICATP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICglucose&#39;</span><span class="p">,</span> <span class="s2">&quot;ICADP&quot;</span><span class="p">,</span> <span class="s1">&#39;ICG6P&#39;</span><span class="p">,</span> <span class="s2">&quot;ICT6P&quot;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jcm</span><span class="o">.</span><span class="n">Jax_MM_Rev_BiBi_w_Inhibition</span><span class="p">(</span><span class="n">substrate1</span><span class="o">=</span><span class="s2">&quot;ICATP&quot;</span><span class="p">,</span> <span class="n">substrate2</span><span class="o">=</span><span class="s2">&quot;ICglucose&quot;</span><span class="p">,</span>
                                               <span class="n">product1</span><span class="o">=</span><span class="s2">&quot;ICADP&quot;</span><span class="p">,</span> <span class="n">product2</span><span class="o">=</span><span class="s2">&quot;ICATP&quot;</span><span class="p">,</span> <span class="n">modifier</span><span class="o">=</span><span class="s2">&quot;ICT6P&quot;</span><span class="p">,</span>
                                               <span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_HXK_Vmax&quot;</span><span class="p">,</span> <span class="n">k_equilibrium</span><span class="o">=</span><span class="s2">&quot;p_HXK1_Keq&quot;</span><span class="p">,</span>
                                               <span class="n">km_substrate1</span><span class="o">=</span><span class="s2">&quot;p_HXK1_Katp&quot;</span><span class="p">,</span>
                                               <span class="n">km_substrate2</span><span class="o">=</span><span class="s2">&quot;p_HXK1_Kglc&quot;</span><span class="p">,</span> <span class="n">km_product1</span><span class="o">=</span><span class="s2">&quot;p_HXK1_Kadp&quot;</span><span class="p">,</span>
                                               <span class="n">km_product2</span><span class="o">=</span><span class="s2">&quot;p_HXK1_Kg6p&quot;</span><span class="p">,</span> <span class="n">ki_inhibitor</span><span class="o">=</span><span class="s2">&quot;p_HXK1_Kt6p&quot;</span><span class="p">,</span> <span class="p">))</span>
<span class="n">v_nth1</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_NTH1&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICtreh&#39;</span><span class="p">,</span> <span class="s1">&#39;ICglucose&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jm</span><span class="o">.</span><span class="n">Jax_MM_Irrev_Uni</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICtreh&quot;</span><span class="p">,</span>
                                  <span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_NTH1_Vmax&quot;</span><span class="p">,</span>
                                  <span class="n">km_substrate</span><span class="o">=</span><span class="s2">&quot;p_NTH1_Ktre&quot;</span><span class="p">))</span>

<span class="n">v_pgi</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_PGI&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICG6P&#39;</span><span class="p">,</span> <span class="s1">&#39;ICF6P&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jm</span><span class="o">.</span><span class="n">Jax_MM_Rev_UniUni</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICG6P&quot;</span><span class="p">,</span> <span class="n">product</span><span class="o">=</span><span class="s2">&quot;ICF6P&quot;</span><span class="p">,</span>
                                   <span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_PGI1_Vmax&quot;</span><span class="p">,</span> <span class="n">k_equilibrium</span><span class="o">=</span><span class="s2">&quot;p_PGI1_Keq&quot;</span><span class="p">,</span>
                                   <span class="n">km_substrate</span><span class="o">=</span><span class="s2">&quot;p_PGI1_Kg6p&quot;</span><span class="p">,</span> <span class="n">km_product</span><span class="o">=</span><span class="s2">&quot;p_PGI1_Kf6p&quot;</span><span class="p">,</span> <span class="p">))</span>

<span class="n">v_sinkg6p</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_sinkG6P&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICG6P&#39;</span><span class="p">,</span> <span class="s1">&#39;ICPHOS&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jm</span><span class="o">.</span><span class="n">Jax_MM_Sink</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICG6P&quot;</span><span class="p">,</span>
                             <span class="n">v_sink</span><span class="o">=</span><span class="s2">&quot;poly_sinkG6P&quot;</span><span class="p">,</span>
                             <span class="n">km_sink</span><span class="o">=</span><span class="s2">&quot;km_sinkG6P&quot;</span><span class="p">))</span>

<span class="n">v_sinkf6p</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_sinkf6P&quot;</span><span class="p">,</span>
                         <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICF6P&#39;</span><span class="p">,</span> <span class="s1">&#39;ICPHOS&#39;</span><span class="p">],</span>
                         <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                         <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">],</span>
                         <span class="n">mechanism</span><span class="o">=</span><span class="n">jm</span><span class="o">.</span><span class="n">Jax_MM_Sink</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICF6P&quot;</span><span class="p">,</span>
                                                  <span class="n">v_sink</span><span class="o">=</span><span class="s2">&quot;poly_sinkF6P&quot;</span><span class="p">,</span>
                                                  <span class="n">km_sink</span><span class="o">=</span><span class="s2">&quot;km_sinkF6P&quot;</span><span class="p">))</span>

<span class="n">v_pgm1</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_PGM1&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICG1P&#39;</span><span class="p">,</span> <span class="s1">&#39;ICG6P&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jm</span><span class="o">.</span><span class="n">Jax_MM_Rev_UniUni</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICG1P&quot;</span><span class="p">,</span> <span class="n">product</span><span class="o">=</span><span class="s2">&quot;ICG6P&quot;</span><span class="p">,</span>
                                   <span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_PGM1_Vmax&quot;</span><span class="p">,</span> <span class="n">k_equilibrium</span><span class="o">=</span><span class="s2">&quot;p_PGM1_Keq&quot;</span><span class="p">,</span>
                                   <span class="n">km_substrate</span><span class="o">=</span><span class="s2">&quot;p_PGM1_Kg1p&quot;</span><span class="p">,</span>
                                   <span class="n">km_product</span><span class="o">=</span><span class="s2">&quot;p_PGM1_Kg6p&quot;</span><span class="p">))</span>  <span class="c1"># to do v_TPS1 for 2nd rate law</span>
</code></pre></div>

<p>The next mechanism is an example of adding a modifier structure to a pre-existing mechanism.
This multiplies the calculated <code>v</code> by the modifier construct.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">## look into how to deal with arbitrary arguments in compute()</span>
<span class="n">mech_tps1</span> <span class="o">=</span> <span class="n">jm</span><span class="o">.</span><span class="n">Jax_MM_Irrev_Bi</span><span class="p">(</span>
    <span class="n">substrate1</span><span class="o">=</span><span class="s2">&quot;ICG6P&quot;</span><span class="p">,</span>
    <span class="n">substrate2</span><span class="o">=</span><span class="s2">&quot;ICG1P&quot;</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_TPS1_Vmax&quot;</span><span class="p">,</span>
    <span class="n">km_substrate1</span><span class="o">=</span><span class="s2">&quot;p_TPS1_Kg6p&quot;</span><span class="p">,</span>
    <span class="n">km_substrate2</span><span class="o">=</span><span class="s2">&quot;p_TPS1_Kudp_glc&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">mech_tps1</span><span class="o">.</span><span class="n">add_modifier</span><span class="p">(</span><span class="n">modifier</span><span class="o">.</span><span class="n">SimpleActivator</span><span class="p">(</span><span class="n">activator</span><span class="o">=</span><span class="s2">&quot;ICF6P&quot;</span><span class="p">,</span> <span class="n">k_A</span><span class="o">=</span><span class="s2">&quot;p_TPS1_KmF6P&quot;</span><span class="p">))</span>

<span class="c1">#modifiers need to be added with 0 stoichiometry</span>
<span class="n">v_tps1</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_TPS1&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICG6P&#39;</span><span class="p">,</span> <span class="s1">&#39;ICG1P&#39;</span><span class="p">,</span> <span class="s1">&#39;ICATP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICT6P&#39;</span><span class="p">,</span> <span class="s1">&#39;ICADP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICPHOS&#39;</span><span class="p">,</span> <span class="s1">&#39;ICF6P&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">mech_tps1</span><span class="p">)</span>
</code></pre></div>

<p>Some other reactions</p>
<div class="codehilite"><pre><span></span><code><span class="n">v_tps2</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_TPS2&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ICT6P&quot;</span><span class="p">,</span> <span class="s2">&quot;ICtreh&quot;</span><span class="p">,</span> <span class="s2">&quot;ICPHOS&quot;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jcm</span><span class="o">.</span><span class="n">Jax_MM_Irrev_Bi_w_Inhibition</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICT6P&quot;</span><span class="p">,</span>
                                               <span class="n">product</span><span class="o">=</span><span class="s2">&quot;ICPHOS&quot;</span><span class="p">,</span>
                                               <span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_TPS2_Vmax&quot;</span><span class="p">,</span>
                                               <span class="n">km_substrate1</span><span class="o">=</span><span class="s2">&quot;p_TPS2_Kt6p&quot;</span><span class="p">,</span>
                                               <span class="n">ki</span><span class="o">=</span><span class="s2">&quot;p_TPS2_Kpi&quot;</span><span class="p">))</span>

<span class="n">v_pfk</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_PFK&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICF6P&#39;</span><span class="p">,</span> <span class="s1">&#39;ICATP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICFBP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICADP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICAMP&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jcm</span><span class="o">.</span><span class="n">Jax_PFK</span><span class="p">(</span><span class="n">substrate1</span><span class="o">=</span><span class="s2">&quot;ICF6P&quot;</span><span class="p">,</span> <span class="n">substrate2</span><span class="o">=</span><span class="s2">&quot;ICATP&quot;</span><span class="p">,</span> <span class="n">product</span><span class="o">=</span><span class="s2">&quot;ICFBP&quot;</span><span class="p">,</span>
                          <span class="n">modifiers</span><span class="o">=</span><span class="s2">&quot;ICAMP&quot;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_PFK_Vmax&quot;</span><span class="p">,</span> <span class="n">kr_F6P</span><span class="o">=</span><span class="s2">&quot;p_PFK_Kf6p&quot;</span><span class="p">,</span>
                          <span class="n">kr_ATP</span><span class="o">=</span><span class="s2">&quot;p_PFK_Katp&quot;</span><span class="p">,</span> <span class="n">gr</span><span class="o">=</span><span class="s2">&quot;p_PFK_gR&quot;</span><span class="p">,</span> <span class="n">c_ATP</span><span class="o">=</span><span class="s2">&quot;p_PFK_Catp&quot;</span><span class="p">,</span>
                          <span class="n">ci_ATP</span><span class="o">=</span><span class="s2">&quot;p_PFK_Ciatp&quot;</span><span class="p">,</span> <span class="n">ci_AMP</span><span class="o">=</span><span class="s2">&quot;p_PFK_Camp&quot;</span><span class="p">,</span> <span class="n">ci_F26BP</span><span class="o">=</span><span class="s2">&quot;p_PFK_Cf26bp&quot;</span><span class="p">,</span>
                          <span class="n">ci_F16BP</span><span class="o">=</span><span class="s2">&quot;p_PFK_Cf16bp&quot;</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="s2">&quot;p_PFK_L&quot;</span><span class="p">,</span> <span class="n">kATP</span><span class="o">=</span><span class="s2">&quot;p_PFK_Kiatp&quot;</span><span class="p">,</span> <span class="n">kAMP</span><span class="o">=</span><span class="s2">&quot;p_PFK_Kamp&quot;</span><span class="p">,</span>
                          <span class="n">F26BP</span><span class="o">=</span><span class="s2">&quot;p_PFK_F26BP&quot;</span><span class="p">,</span> <span class="n">kF26BP</span><span class="o">=</span><span class="s2">&quot;p_PFK_Kf26bp&quot;</span><span class="p">,</span> <span class="n">kF16BP</span><span class="o">=</span><span class="s2">&quot;p_PFK_Kf16bp&quot;</span><span class="p">))</span>
<span class="n">v_ald</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_ALD&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICFBP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICGAP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICDHAP&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jm</span><span class="o">.</span><span class="n">Jax_MM_Rev_UniBi</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICFBP&quot;</span><span class="p">,</span> <span class="n">product1</span><span class="o">=</span><span class="s2">&quot;ICGAP&quot;</span><span class="p">,</span> <span class="n">product2</span><span class="o">=</span><span class="s2">&quot;ICDHAP&quot;</span><span class="p">,</span>
                                  <span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_FBA1_Vmax&quot;</span><span class="p">,</span> <span class="n">k_equilibrium</span><span class="o">=</span><span class="s2">&quot;p_FBA1_Keq&quot;</span><span class="p">,</span>
                                  <span class="n">km_substrate</span><span class="o">=</span><span class="s2">&quot;p_FBA1_Kf16bp&quot;</span><span class="p">,</span> <span class="n">km_product1</span><span class="o">=</span><span class="s2">&quot;p_FBA1_Kglyceral3p&quot;</span><span class="p">,</span>
                                  <span class="n">km_product2</span><span class="o">=</span><span class="s2">&quot;p_FBA1_Kdhap&quot;</span><span class="p">,</span> <span class="p">))</span>

<span class="n">v_tpi1</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_TPI1&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICDHAP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICGAP&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jm</span><span class="o">.</span><span class="n">Jax_MM_Rev_UniUni</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICDHAP&quot;</span><span class="p">,</span> <span class="n">product</span><span class="o">=</span><span class="s2">&quot;ICGAP&quot;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_TPI1_Vmax&quot;</span><span class="p">,</span>
                                   <span class="n">k_equilibrium</span><span class="o">=</span><span class="s2">&quot;p_TPI1_Keq&quot;</span><span class="p">,</span> <span class="n">km_substrate</span><span class="o">=</span><span class="s2">&quot;p_TPI1_Kdhap&quot;</span><span class="p">,</span>
                                   <span class="n">km_product</span><span class="o">=</span><span class="s2">&quot;p_TPI1_Kglyceral3p&quot;</span><span class="p">,</span> <span class="p">))</span>

<span class="n">v_sinkgap</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_sinkGAP&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICGAP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICPHOS&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jm</span><span class="o">.</span><span class="n">Jax_MM_Sink</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICGAP&quot;</span><span class="p">,</span> <span class="n">v_sink</span><span class="o">=</span><span class="s2">&quot;poly_sinkGAP&quot;</span><span class="p">,</span>
                             <span class="n">km_sink</span><span class="o">=</span><span class="s2">&quot;poly_sinkGAP&quot;</span><span class="p">))</span>

<span class="c1">## look into how to deal with arbitrary arguments in compute()</span>
<span class="n">v_g3pdh</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_3GPDH&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICDHAP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICNADH&#39;</span><span class="p">,</span> <span class="s1">&#39;ICG3P&#39;</span><span class="p">,</span> <span class="s1">&#39;ICNAD&#39;</span><span class="p">,</span> <span class="s1">&#39;ICFBP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICATP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICADP&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jcm</span><span class="o">.</span><span class="n">G3PDH_Func_TEMP</span><span class="p">(</span><span class="n">substrate1</span><span class="o">=</span><span class="s2">&quot;ICDHAP&quot;</span><span class="p">,</span>
                                  <span class="n">substrate2</span><span class="o">=</span><span class="s2">&quot;ICNADH&quot;</span><span class="p">,</span>
                                  <span class="n">product1</span><span class="o">=</span><span class="s2">&quot;ICG3P&quot;</span><span class="p">,</span>
                                  <span class="n">product2</span><span class="o">=</span><span class="s2">&quot;ICNAD&quot;</span><span class="p">,</span>
                                  <span class="n">modifier1</span><span class="o">=</span><span class="s2">&quot;ICFBP&quot;</span><span class="p">,</span>
                                  <span class="n">modifier2</span><span class="o">=</span><span class="s2">&quot;ICATP&quot;</span><span class="p">,</span>
                                  <span class="n">modifier3</span><span class="o">=</span><span class="s2">&quot;ICADP&quot;</span><span class="p">,</span>
                                  <span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_GPD1_Vmax&quot;</span><span class="p">,</span>
                                  <span class="n">k_equilibrium</span><span class="o">=</span><span class="s2">&quot;p_GPD1_Keq&quot;</span><span class="p">,</span>
                                  <span class="n">km_substrate1</span><span class="o">=</span><span class="s2">&quot;p_GPD1_Kdhap&quot;</span><span class="p">,</span>
                                  <span class="n">km_substrate2</span><span class="o">=</span><span class="s2">&quot;p_GPD1_Knadh&quot;</span><span class="p">,</span>
                                  <span class="n">km_product1</span><span class="o">=</span><span class="s2">&quot;p_GPD1_Kglyc3p&quot;</span><span class="p">,</span>
                                  <span class="n">km_product2</span><span class="o">=</span><span class="s2">&quot;p_GPD1_Knad&quot;</span><span class="p">,</span>
                                  <span class="n">ka1</span><span class="o">=</span><span class="s2">&quot;p_GPD1_Kf16bp&quot;</span><span class="p">,</span>
                                  <span class="n">ka2</span><span class="o">=</span><span class="s2">&quot;p_GPD1_Katp&quot;</span><span class="p">,</span>
                                  <span class="n">ka3</span><span class="o">=</span><span class="s2">&quot;p_GPD1_Kadp&quot;</span><span class="p">,</span> <span class="p">))</span>

<span class="n">v_gapdh</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_GAPDH&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICGAP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICNAD&#39;</span><span class="p">,</span> <span class="s1">&#39;ICPHOS&#39;</span><span class="p">,</span> <span class="s1">&#39;ICBPG&#39;</span><span class="p">,</span> <span class="s1">&#39;ICNADH&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jcm</span><span class="o">.</span><span class="n">Jax_MM_Ordered_Bi_Tri</span><span class="p">(</span><span class="n">substrate1</span><span class="o">=</span><span class="s2">&quot;ICGAP&quot;</span><span class="p">,</span> <span class="n">substrate2</span><span class="o">=</span><span class="s2">&quot;ICNAD&quot;</span><span class="p">,</span>
                                        <span class="n">substrate3</span><span class="o">=</span><span class="s2">&quot;ICPHOS&quot;</span><span class="p">,</span> <span class="n">product1</span><span class="o">=</span><span class="s2">&quot;ICBPG&quot;</span><span class="p">,</span>
                                        <span class="n">product2</span><span class="o">=</span><span class="s2">&quot;ICNADH&quot;</span><span class="p">,</span>
                                        <span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_GAPDH_Vmax&quot;</span><span class="p">,</span> <span class="n">k_equilibrium</span><span class="o">=</span><span class="s2">&quot;p_TDH1_Keq&quot;</span><span class="p">,</span>
                                        <span class="n">km_substrate1</span><span class="o">=</span><span class="s2">&quot;p_TDH1_Kglyceral3p&quot;</span><span class="p">,</span> <span class="n">km_substrate2</span><span class="o">=</span><span class="s2">&quot;p_TDH1_Knad&quot;</span><span class="p">,</span>
                                        <span class="n">ki</span><span class="o">=</span><span class="s2">&quot;p_TDH1_Kpi&quot;</span><span class="p">,</span> <span class="n">km_product1</span><span class="o">=</span><span class="s2">&quot;p_TDH1_Kglycerate13bp&quot;</span><span class="p">,</span>
                                        <span class="n">km_product2</span><span class="o">=</span><span class="s2">&quot;p_TDH1_Knadh&quot;</span><span class="p">))</span>

<span class="n">v_pgk</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_PGK&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICBPG&#39;</span><span class="p">,</span> <span class="s1">&#39;ICADP&#39;</span><span class="p">,</span> <span class="s1">&#39;IC3PG&#39;</span><span class="p">,</span> <span class="s1">&#39;ICATP&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jm</span><span class="o">.</span><span class="n">Jax_MM_Rev_BiBi</span><span class="p">(</span><span class="n">substrate1</span><span class="o">=</span><span class="s2">&quot;ICBPG&quot;</span><span class="p">,</span>
                                 <span class="n">substrate2</span><span class="o">=</span><span class="s2">&quot;ICADP&quot;</span><span class="p">,</span>
                                 <span class="n">product1</span><span class="o">=</span><span class="s2">&quot;IC3PG&quot;</span><span class="p">,</span>
                                 <span class="n">product2</span><span class="o">=</span><span class="s2">&quot;ICATP&quot;</span><span class="p">,</span>
                                 <span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_PGK_VmPGK&quot;</span><span class="p">,</span>
                                 <span class="n">k_equilibrium</span><span class="o">=</span><span class="s2">&quot;p_PGK_KeqPGK&quot;</span><span class="p">,</span>
                                 <span class="n">km_substrate1</span><span class="o">=</span><span class="s2">&quot;p_PGK_KmPGKBPG&quot;</span><span class="p">,</span>
                                 <span class="n">km_substrate2</span><span class="o">=</span><span class="s2">&quot;p_PGK_KmPGKADP&quot;</span><span class="p">,</span>
                                 <span class="n">km_product1</span><span class="o">=</span><span class="s2">&quot;p_PGK_KmPGKP3G&quot;</span><span class="p">,</span>
                                 <span class="n">km_product2</span><span class="o">=</span><span class="s2">&quot;p_PGK_KmPGKATP&quot;</span><span class="p">,</span> <span class="p">))</span>

<span class="n">v_sink3pga</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_sink3PGA&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;IC3PG&#39;</span><span class="p">,</span> <span class="s1">&#39;ICPHOS&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jm</span><span class="o">.</span><span class="n">Jax_MM_Sink</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;IC3PG&quot;</span><span class="p">,</span> <span class="n">v_sink</span><span class="o">=</span><span class="s2">&quot;poly_sinkP3G&quot;</span><span class="p">,</span> <span class="n">km_sink</span><span class="o">=</span><span class="s2">&quot;km_sinkP3G&quot;</span><span class="p">))</span>

<span class="n">mech_hor2</span> <span class="o">=</span> <span class="n">jm</span><span class="o">.</span><span class="n">Jax_MM_Irrev_Uni</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICG3P&quot;</span><span class="p">,</span>
                                <span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_HOR2_Vmax&quot;</span><span class="p">,</span>
                                <span class="n">km_substrate</span><span class="o">=</span><span class="s2">&quot;p_HOR2_Kglyc3p&quot;</span><span class="p">)</span>

<span class="n">mech_hor2</span><span class="o">.</span><span class="n">add_modifier</span><span class="p">(</span><span class="n">modifier</span><span class="o">.</span><span class="n">SimpleInhibitor</span><span class="p">(</span><span class="n">inhibitor</span><span class="o">=</span><span class="s2">&quot;ICPHOS&quot;</span><span class="p">,</span> <span class="n">k_I</span><span class="o">=</span><span class="s2">&quot;p_HOR2_Kpi&quot;</span><span class="p">))</span>

<span class="c1">## look into how to deal with arbitrary arguments in compute()</span>
<span class="n">v_hor2</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_HOR2&quot;</span><span class="p">,</span>
                      <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICG3P&#39;</span><span class="p">,</span> <span class="s1">&#39;ICglyc&#39;</span><span class="p">,</span> <span class="s1">&#39;ICPHOS&#39;</span><span class="p">],</span>
                      <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                      <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
                      <span class="n">mechanism</span><span class="o">=</span><span class="n">mech_hor2</span><span class="p">)</span>

<span class="c1">### next up  v_GlycT</span>

<span class="n">mech_glyct_ic</span> <span class="o">=</span> <span class="n">jm</span><span class="o">.</span><span class="n">Jax_Diffusion</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICglyc&quot;</span><span class="p">,</span>
                                 <span class="n">enzyme</span><span class="o">=</span><span class="s2">&quot;f_GLYCEROL_e&quot;</span><span class="p">,</span>
                                 <span class="n">transport_coef</span><span class="o">=</span><span class="s2">&quot;p_GlycerolTransport&quot;</span><span class="p">)</span>
<span class="n">v_glyct_ic</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_GlycT_IC&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICglyc&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">mech_glyct_ic</span><span class="p">)</span>

<span class="n">mech_glyct_ec</span> <span class="o">=</span> <span class="n">jm</span><span class="o">.</span><span class="n">Jax_Diffusion</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICglyc&quot;</span><span class="p">,</span>
                                 <span class="n">enzyme</span><span class="o">=</span><span class="s2">&quot;f_GLYCEROL_e&quot;</span><span class="p">,</span>
                                 <span class="n">transport_coef</span><span class="o">=</span><span class="s2">&quot;p_GlycerolTransport&quot;</span><span class="p">)</span>
<span class="n">mech_glyct_ec</span><span class="o">.</span><span class="n">add_modifier</span><span class="p">(</span><span class="n">modifier</span><span class="o">.</span><span class="n">BiomassModifier</span><span class="p">(</span><span class="n">biomass</span><span class="o">=</span><span class="s2">&quot;ECbiomass&quot;</span><span class="p">))</span>

<span class="n">v_glyct_ec</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_GlycT_EC&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICglyc&#39;</span><span class="p">,</span> <span class="s1">&#39;ECglyc&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">mech_glyct_ec</span><span class="p">)</span>

<span class="n">v_pgm</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_PGM&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;IC3PG&#39;</span><span class="p">,</span> <span class="s1">&#39;IC2PG&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jm</span><span class="o">.</span><span class="n">Jax_MM_Rev_UniUni</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;IC3PG&quot;</span><span class="p">,</span>
                                   <span class="n">product</span><span class="o">=</span><span class="s2">&quot;IC2PG&quot;</span><span class="p">,</span>
                                   <span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_PGM_Vm&quot;</span><span class="p">,</span>
                                   <span class="n">k_equilibrium</span><span class="o">=</span><span class="s2">&quot;p_PGM_Keq&quot;</span><span class="p">,</span>
                                   <span class="n">km_substrate</span><span class="o">=</span><span class="s2">&quot;p_PGM_K3pg&quot;</span><span class="p">,</span>
                                   <span class="n">km_product</span><span class="o">=</span><span class="s2">&quot;p_PGM_K2pg&quot;</span><span class="p">,</span> <span class="p">))</span>

<span class="n">v_eno2</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_ENO2&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;IC2PG&#39;</span><span class="p">,</span> <span class="s1">&#39;ICPEP&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jm</span><span class="o">.</span><span class="n">Jax_MM_Rev_UniUni</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;IC2PG&quot;</span><span class="p">,</span>
                                   <span class="n">product</span><span class="o">=</span><span class="s2">&quot;ICPEP&quot;</span><span class="p">,</span>
                                   <span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_ENO1_Vm&quot;</span><span class="p">,</span>
                                   <span class="n">k_equilibrium</span><span class="o">=</span><span class="s2">&quot;p_ENO1_Keq&quot;</span><span class="p">,</span>
                                   <span class="n">km_substrate</span><span class="o">=</span><span class="s2">&quot;p_ENO1_K2pg&quot;</span><span class="p">,</span>
                                   <span class="n">km_product</span><span class="o">=</span><span class="s2">&quot;p_ENO1_Kpep&quot;</span><span class="p">,</span> <span class="p">))</span>

<span class="n">v_sinkpep</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_sinkPEP&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICPEP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICPHOS&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jm</span><span class="o">.</span><span class="n">Jax_MM_Sink</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICPEP&quot;</span><span class="p">,</span>
                             <span class="n">v_sink</span><span class="o">=</span><span class="s2">&quot;poly_sinkPEP&quot;</span><span class="p">,</span>
                             <span class="n">km_sink</span><span class="o">=</span><span class="s2">&quot;km_sinkPEP&quot;</span><span class="p">))</span>

<span class="n">v_pyk1</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;v_PYK1&#39;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICPEP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICADP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICPYR&#39;</span><span class="p">,</span> <span class="s1">&#39;ICATP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICFBP&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jcm</span><span class="o">.</span><span class="n">Jax_Hill_Irreversible_Bi_Activation</span><span class="p">(</span><span class="n">substrate1</span><span class="o">=</span><span class="s2">&quot;ICPEP&quot;</span><span class="p">,</span>
                                                      <span class="n">substrate2</span><span class="o">=</span><span class="s2">&quot;ICADP&quot;</span><span class="p">,</span>
                                                      <span class="n">activator</span><span class="o">=</span><span class="s2">&quot;ICFBP&quot;</span><span class="p">,</span>
                                                      <span class="n">product</span><span class="o">=</span><span class="s2">&quot;ICATP&quot;</span><span class="p">,</span>
                                                      <span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_PYK1_Vm&quot;</span><span class="p">,</span>
                                                      <span class="n">hill</span><span class="o">=</span><span class="s2">&quot;p_PYK1_hill&quot;</span><span class="p">,</span>
                                                      <span class="n">k_substrate1</span><span class="o">=</span><span class="s2">&quot;p_PYK1_Kpep&quot;</span><span class="p">,</span>
                                                      <span class="n">k_substrate2</span><span class="o">=</span><span class="s2">&quot;p_PYK1_Kadp&quot;</span><span class="p">,</span>
                                                      <span class="n">k_product</span><span class="o">=</span><span class="s2">&quot;p_PYK1_Katp&quot;</span><span class="p">,</span>
                                                      <span class="n">k_activator</span><span class="o">=</span><span class="s2">&quot;p_PYK1_Kf16bp&quot;</span><span class="p">,</span>
                                                      <span class="n">l</span><span class="o">=</span><span class="s2">&quot;p_PYK1_L&quot;</span><span class="p">,</span> <span class="p">))</span>
<span class="n">v_sinkpyr</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;v_sinkPYR&#39;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICPYR&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jm</span><span class="o">.</span><span class="n">Jax_MM_Sink</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICPYR&quot;</span><span class="p">,</span>
                             <span class="n">v_sink</span><span class="o">=</span><span class="s2">&quot;poly_sinkPYR&quot;</span><span class="p">,</span>
                             <span class="n">km_sink</span><span class="o">=</span><span class="s2">&quot;km_sinkPYR&quot;</span><span class="p">))</span>

<span class="n">v_adh</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;v_ADH&#39;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICNAD&#39;</span><span class="p">,</span> <span class="s1">&#39;ICETOH&#39;</span><span class="p">,</span> <span class="s1">&#39;ICNADH&#39;</span><span class="p">,</span> <span class="s1">&#39;ICACE&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jcm</span><span class="o">.</span><span class="n">Jax_ADH</span><span class="p">(</span><span class="n">NAD</span><span class="o">=</span><span class="s2">&quot;ICNAD&quot;</span><span class="p">,</span>
                          <span class="n">ETOH</span><span class="o">=</span><span class="s2">&quot;ICETOH&quot;</span><span class="p">,</span>
                          <span class="n">NADH</span><span class="o">=</span><span class="s2">&quot;ICNADH&quot;</span><span class="p">,</span>
                          <span class="n">ACE</span><span class="o">=</span><span class="s2">&quot;ICACE&quot;</span><span class="p">,</span>
                          <span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_ADH_VmADH&quot;</span><span class="p">,</span>
                          <span class="n">k_equilibrium</span><span class="o">=</span><span class="s2">&quot;p_ADH_KeqADH&quot;</span><span class="p">,</span>
                          <span class="n">km_substrate1</span><span class="o">=</span><span class="s2">&quot;p_ADH_KiADHNAD&quot;</span><span class="p">,</span>
                          <span class="n">km_substrate2</span><span class="o">=</span><span class="s2">&quot;p_ADH_KmADHETOH&quot;</span><span class="p">,</span>
                          <span class="n">km_product1</span><span class="o">=</span><span class="s2">&quot;p_ADH_KmADHACE&quot;</span><span class="p">,</span>
                          <span class="n">km_product2</span><span class="o">=</span><span class="s2">&quot;p_ADH_KmADHNADH&quot;</span><span class="p">,</span>
                          <span class="n">ki_substrate1</span><span class="o">=</span><span class="s2">&quot;p_ADH_KiADHNAD&quot;</span><span class="p">,</span>
                          <span class="n">ki_substrate2</span><span class="o">=</span><span class="s2">&quot;p_ADH_KiADHETOH&quot;</span><span class="p">,</span>
                          <span class="n">ki_product1</span><span class="o">=</span><span class="s2">&quot;p_ADH_KiADHACE&quot;</span><span class="p">,</span>
                          <span class="n">ki_product2</span><span class="o">=</span><span class="s2">&quot;p_ADH_KiADHNADH&quot;</span><span class="p">,</span>
                          <span class="n">exprs_cor</span><span class="o">=</span><span class="s2">&quot;p_ADH_ExprsCor&quot;</span><span class="p">,</span> <span class="p">))</span>

<span class="n">v_sinkace</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;v_sinkACE&#39;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICACE&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jm</span><span class="o">.</span><span class="n">Jax_MM_Sink</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICACE&quot;</span><span class="p">,</span>
                             <span class="n">v_sink</span><span class="o">=</span><span class="s2">&quot;poly_sinkACE&quot;</span><span class="p">,</span>
                             <span class="n">km_sink</span><span class="o">=</span><span class="s2">&quot;km_sinkACE&quot;</span><span class="p">))</span>

<span class="c1">#from a modelling perspective this is awkward. we have a rate that only needs to be modified for ECETOH, not ICETOH.</span>
<span class="c1"># where therefore need to split the stoichiometry as well, while maintaining the same parameters</span>
<span class="n">mech_etoht_ic</span> <span class="o">=</span> <span class="n">jm</span><span class="o">.</span><span class="n">Jax_Diffusion</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICETOH&quot;</span><span class="p">,</span>
                                 <span class="n">enzyme</span><span class="o">=</span><span class="s2">&quot;f_ETOH_e&quot;</span><span class="p">,</span>
                                 <span class="n">transport_coef</span><span class="o">=</span><span class="s2">&quot;p_kETOHtransport&quot;</span><span class="p">)</span>
</code></pre></div>

<p>Sometimes, a flux may need to be scaled differently per ODEs. Suppose we 
have the original mass-balances in the glycolysis model, 
where for the intracellular concentration we do not scale the flux, but for the
extracellular we do.</p>
<p>$$\frac{d etoh_{ic}}{dt}=- v_{ETOHT} + ... $$
$$\frac{d etoh_{ec}}{dt}=+ v_{ETOHT} * [biomass] * 0.002 + ... $$</p>
<p>We can first define a mechanisms for ICETOH and then modify this for ECETOH.
This requires us to use two <code>Reaction</code> objects, and set stoichiometry to 0 to 
ensure that they are not wrongly affected by the scaling.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">#only outgoing</span>
<span class="n">v_etoht_ic</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_ETOHT_IC&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICETOH&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">mech_etoht_ic</span><span class="p">)</span>

<span class="n">mech_etoht_ec</span> <span class="o">=</span> <span class="n">jm</span><span class="o">.</span><span class="n">Jax_Diffusion</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICETOH&quot;</span><span class="p">,</span>
                                 <span class="n">enzyme</span><span class="o">=</span><span class="s2">&quot;f_ETOH_e&quot;</span><span class="p">,</span>
                                 <span class="n">transport_coef</span><span class="o">=</span><span class="s2">&quot;p_kETOHtransport&quot;</span><span class="p">)</span>
<span class="n">mech_etoht_ec</span><span class="o">.</span><span class="n">add_modifier</span><span class="p">(</span><span class="n">modifier</span><span class="o">.</span><span class="n">BiomassModifier</span><span class="p">(</span><span class="n">biomass</span><span class="o">=</span><span class="s1">&#39;ECbiomass&#39;</span><span class="p">))</span>


<span class="n">v_etoht_ec</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_ETOHT_EC&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICETOH&#39;</span><span class="p">,</span> <span class="s1">&#39;ECETOH&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">mech_etoht_ec</span><span class="p">)</span>
</code></pre></div>

<p>Further finish the reaction definitions</p>
<div class="codehilite"><pre><span></span><code><span class="n">v_atpmito</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;v_ATPMITO&#39;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICATP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICPHOS&#39;</span><span class="p">,</span> <span class="s1">&#39;ICADP&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jm</span><span class="o">.</span><span class="n">Jax_MM_Irrev_Bi</span><span class="p">(</span><span class="n">substrate1</span><span class="o">=</span><span class="s2">&quot;ICADP&quot;</span><span class="p">,</span>
                                 <span class="n">substrate2</span><span class="o">=</span><span class="s2">&quot;ICPHOS&quot;</span><span class="p">,</span>
                                 <span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_mitoVmax&quot;</span><span class="p">,</span>
                                 <span class="n">km_substrate1</span><span class="o">=</span><span class="s2">&quot;p_mitoADPKm&quot;</span><span class="p">,</span>
                                 <span class="n">km_substrate2</span><span class="o">=</span><span class="s2">&quot;p_mitoPiKm&quot;</span><span class="p">))</span>

<span class="n">v_atpase</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_ATPASE&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICATP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICPHOS&#39;</span><span class="p">,</span> <span class="s1">&#39;ICADP&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jcm</span><span class="o">.</span><span class="n">Jax_ATPase</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICATP&quot;</span><span class="p">,</span>
                             <span class="n">product</span><span class="o">=</span><span class="s2">&quot;ICADP&quot;</span><span class="p">,</span>
                             <span class="n">ATPase_ratio</span><span class="o">=</span><span class="s2">&quot;p_ATPase_ratio&quot;</span><span class="p">))</span>
<span class="n">v_adk</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_ADK&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICADP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICATP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICAMP&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jcm</span><span class="o">.</span><span class="n">Jax_MA_Rev_Bi</span><span class="p">(</span><span class="n">substrate1</span><span class="o">=</span><span class="s2">&quot;ICADP&quot;</span><span class="p">,</span>
                                <span class="n">substrate2</span><span class="o">=</span><span class="s2">&quot;ICADP&quot;</span><span class="p">,</span>
                                <span class="n">product1</span><span class="o">=</span><span class="s2">&quot;ICATP&quot;</span><span class="p">,</span>
                                <span class="n">product2</span><span class="o">=</span><span class="s2">&quot;ICAMP&quot;</span><span class="p">,</span>
                                <span class="n">k_equilibrium</span><span class="o">=</span><span class="s2">&quot;p_ADK1_Keq&quot;</span><span class="p">,</span>
                                <span class="n">k_fwd</span><span class="o">=</span><span class="s2">&quot;p_ADK1_k&quot;</span><span class="p">))</span>
<span class="n">v_vacpi</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_VACPI&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICPHOS&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jcm</span><span class="o">.</span><span class="n">Jax_MA_Rev</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICPHOS&quot;</span><span class="p">,</span>
                             <span class="n">k</span><span class="o">=</span><span class="s2">&quot;p_vacuolePi_k&quot;</span><span class="p">,</span>
                             <span class="n">steady_state_substrate</span><span class="o">=</span><span class="s2">&quot;p_vacuolePi_steadyStatePi&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">v_amd1</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_AMD1&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICAMP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICIMP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICATP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICPHOS&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jcm</span><span class="o">.</span><span class="n">Jax_Amd1</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICAMP&quot;</span><span class="p">,</span>
                           <span class="n">product</span><span class="o">=</span><span class="s2">&quot;ICATP&quot;</span><span class="p">,</span>
                           <span class="n">modifier</span><span class="o">=</span><span class="s2">&quot;ICPHOS&quot;</span><span class="p">,</span>
                           <span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_Amd1_Vmax&quot;</span><span class="p">,</span>
                           <span class="n">k50</span><span class="o">=</span><span class="s2">&quot;p_Amd1_K50&quot;</span><span class="p">,</span>
                           <span class="n">ki</span><span class="o">=</span><span class="s2">&quot;p_Amd1_Kpi&quot;</span><span class="p">,</span>
                           <span class="n">k_atp</span><span class="o">=</span><span class="s2">&quot;p_Amd1_Katp&quot;</span><span class="p">,</span> <span class="p">))</span>
<span class="n">v_ade1312</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_ADE1312&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICIMP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICAMP&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jm</span><span class="o">.</span><span class="n">Jax_MA_Irrev</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICIMP&quot;</span><span class="p">,</span>
                              <span class="n">k_fwd</span><span class="o">=</span><span class="s2">&quot;p_Ade13_Ade12_k&quot;</span><span class="p">))</span>
<span class="n">v_isn1</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_ISN1&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICIMP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICPHOS&#39;</span><span class="p">,</span> <span class="s1">&#39;ICINO&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jm</span><span class="o">.</span><span class="n">Jax_MA_Irrev</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICIMP&quot;</span><span class="p">,</span>
                              <span class="n">k_fwd</span><span class="o">=</span><span class="s2">&quot;p_Isn1_k&quot;</span><span class="p">))</span>

<span class="n">v_pnp1</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_PNP1&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICINO&#39;</span><span class="p">,</span> <span class="s1">&#39;ICHYP&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jm</span><span class="o">.</span><span class="n">Jax_MA_Irrev</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICINO&quot;</span><span class="p">,</span>
                              <span class="n">k_fwd</span><span class="o">=</span><span class="s2">&quot;p_Pnp1_k&quot;</span><span class="p">))</span>

<span class="n">v_hpt1</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_HPT1&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICIMP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICPHOS&#39;</span><span class="p">,</span> <span class="s1">&#39;ICHYP&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jm</span><span class="o">.</span><span class="n">Jax_MA_Irrev</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICHYP&quot;</span><span class="p">,</span> <span class="n">k_fwd</span><span class="o">=</span><span class="s2">&quot;p_Hpt1_k&quot;</span><span class="p">))</span>

<span class="c1">#v_pdcs</span>
<span class="n">v_pdc</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_PDC&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICPYR&#39;</span><span class="p">,</span> <span class="s1">&#39;ICACE&#39;</span><span class="p">,</span> <span class="s1">&#39;ICPHOS&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jcm</span><span class="o">.</span><span class="n">Jax_Hill_Irreversible_Inhibition</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICPYR&quot;</span><span class="p">,</span>
                                                   <span class="n">inhibitor</span><span class="o">=</span><span class="s2">&quot;ICPHOS&quot;</span><span class="p">,</span>
                                                   <span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_PDC1_Vmax&quot;</span><span class="p">,</span>
                                                   <span class="n">k_half_substrate</span><span class="o">=</span><span class="s2">&quot;p_PDC1_Kpyr&quot;</span><span class="p">,</span>
                                                   <span class="n">hill</span><span class="o">=</span><span class="s2">&quot;p_PDC1_hill&quot;</span><span class="p">,</span>
                                                   <span class="n">ki</span><span class="o">=</span><span class="s2">&quot;p_PDC1_Kpi&quot;</span><span class="p">,</span> <span class="p">))</span>
<span class="n">v_mitonadh</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_MITONADH&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICNADH&#39;</span><span class="p">,</span> <span class="s1">&#39;ICNAD&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jm</span><span class="o">.</span><span class="n">Jax_MM</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICNADH&quot;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_mitoNADHVmax&quot;</span><span class="p">,</span>
                        <span class="n">km</span><span class="o">=</span><span class="s2">&quot;p_mitoNADHKm&quot;</span><span class="p">))</span>  <span class="c1"># I think this can be replaced by Jax_MM_Irrev_Uni</span>

<span class="n">v_ugp</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_UGP&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICG1P&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jm</span><span class="o">.</span><span class="n">Jax_Constant_Flux</span><span class="p">(</span><span class="n">v</span><span class="o">=</span><span class="s2">&quot;flux_ugp&quot;</span><span class="p">))</span>

<span class="c1">#modification to mimic the glycolysis model</span>
<span class="n">v_transport_reactions</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;v_TRANSPORT&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ECETOH&#39;</span><span class="p">,</span> <span class="s1">&#39;ECglyc&#39;</span><span class="p">],</span>
    <span class="n">compartments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">],</span>
    <span class="n">stoichiometry</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">mechanism</span><span class="o">=</span><span class="n">jcm</span><span class="o">.</span><span class="n">Jax_Transport_Flux_Correction</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ECETOH&quot;</span><span class="p">,</span> <span class="n">dilution_rate</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>

<h2 id="setting-up-the-ode-system">Setting up the ODE system</h2>
<p>We now pass all reactions and compartment definitions to <code>JaxKineticModelBuild</code>, 
similarly to how it was performed in the Building Models tutorial.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">## we can add modifications to mechanism through the JaxKineticModelBuild obejct</span>
<span class="n">compartments</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">reactions</span> <span class="o">=</span> <span class="p">[</span><span class="n">v_hxk</span><span class="p">,</span> <span class="n">v_glt</span><span class="p">,</span> <span class="n">v_nth1</span><span class="p">,</span> <span class="n">v_pgi</span><span class="p">,</span>
             <span class="n">v_sinkg6p</span><span class="p">,</span> <span class="n">v_sinkf6p</span><span class="p">,</span> <span class="n">v_pgm1</span><span class="p">,</span>
             <span class="n">v_tps1</span><span class="p">,</span> <span class="n">v_tps2</span><span class="p">,</span> <span class="n">v_pfk</span><span class="p">,</span> <span class="n">v_ald</span><span class="p">,</span>
             <span class="n">v_tpi1</span><span class="p">,</span> <span class="n">v_sinkgap</span><span class="p">,</span> <span class="n">v_g3pdh</span><span class="p">,</span>
             <span class="n">v_gapdh</span><span class="p">,</span> <span class="n">v_pgk</span><span class="p">,</span> <span class="n">v_sink3pga</span><span class="p">,</span>
             <span class="n">v_hor2</span><span class="p">,</span> <span class="n">v_glyct_ic</span><span class="p">,</span> <span class="n">v_glyct_ec</span><span class="p">,</span>
             <span class="n">v_pgm</span><span class="p">,</span> <span class="n">v_eno2</span><span class="p">,</span> <span class="n">v_sinkpep</span><span class="p">,</span>
             <span class="n">v_pyk1</span><span class="p">,</span> <span class="n">v_sinkpyr</span><span class="p">,</span> <span class="n">v_adh</span><span class="p">,</span>
             <span class="n">v_sinkace</span><span class="p">,</span> <span class="n">v_etoht_ic</span><span class="p">,</span> <span class="n">v_etoht_ec</span><span class="p">,</span>
             <span class="n">v_atpmito</span><span class="p">,</span> <span class="n">v_atpase</span><span class="p">,</span> <span class="n">v_adk</span><span class="p">,</span>
             <span class="n">v_vacpi</span><span class="p">,</span> <span class="n">v_amd1</span><span class="p">,</span> <span class="n">v_ade1312</span><span class="p">,</span>
             <span class="n">v_isn1</span><span class="p">,</span> <span class="n">v_pnp1</span><span class="p">,</span> <span class="n">v_hpt1</span><span class="p">,</span>
             <span class="n">v_pdc</span><span class="p">,</span> <span class="n">v_mitonadh</span><span class="p">,</span> <span class="n">v_ugp</span><span class="p">,</span>
             <span class="n">v_transport_reactions</span><span class="p">]</span>

<span class="n">kmodel</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">JaxKineticModelBuild</span><span class="p">(</span><span class="n">reactions</span><span class="p">,</span> <span class="n">compartments</span><span class="p">)</span>
</code></pre></div>

<h2 id="cubic-spline-boundary-condition">Cubic spline boundary condition</h2>
<p>As mentioned in the Building Models tutorial, we can add boundary conditions for 
species that are either constant or time-dependent. Often, it is necessary 
to do interpolation, such as cubic spline, to model a perturbation. We can 
build expressions for that using sympy, pass these as a string input
to the boundary condition class, which builds the cubic spline for us, that can
be exported to an sbml.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># do an interpolation using sympy for EC glucose and add as a boundary condition</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;datasets/VanHeerden_Glucose_Pulse/FF1_timeseries_format.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;ECglucose&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
<span class="n">d_range</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;ECglucose&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">spline</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">interpolating_spline</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">domain</span><span class="p">,</span> <span class="n">d_range</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;true spline&#39;</span><span class="p">,</span> <span class="n">spline</span><span class="p">)</span>
<span class="n">spline</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">spline</span><span class="p">)</span>
<span class="n">kmodel</span><span class="o">.</span><span class="n">add_boundary</span><span class="p">(</span><span class="s1">&#39;ECglucose&#39;</span><span class="p">,</span> <span class="n">jkm</span><span class="o">.</span><span class="n">BoundaryCondition</span><span class="p">(</span><span class="n">spline</span><span class="p">))</span>
</code></pre></div>

<h2 id="parameters-and-initial-conditions">Parameters and initial conditions</h2>
<p>We add parameters from literature values and the initial conditions 
are initialized.</p>
<div class="codehilite"><pre><span></span><code><span class="n">kmodel_sim</span> <span class="o">=</span> <span class="n">jkm</span><span class="o">.</span><span class="n">NeuralODEBuild</span><span class="p">(</span><span class="n">kmodel</span><span class="p">)</span>

<span class="n">S</span> <span class="o">=</span> <span class="n">kmodel</span><span class="o">.</span><span class="n">stoichiometric_matrix</span>


<span class="n">lit_params</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">((</span><span class="s1">&#39;parameter_initializations/&#39;</span>
                          <span class="s1">&#39;Glycolysis_model/&#39;</span>
                          <span class="s1">&#39;parameter_initialization_glycolysis&#39;</span>
                          <span class="s1">&#39;_literature_values.csv&#39;</span><span class="p">),</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()[</span><span class="s1">&#39;0&#39;</span><span class="p">]</span>

<span class="n">D</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">kmodel</span><span class="o">.</span><span class="n">parameter_names</span><span class="p">:</span>
    <span class="c1">#need to deal with the poly_sinks dependent on dilution rate</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">lit_params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">parameters</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">lit_params</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;poly_sinkG6P&#39;</span><span class="p">:</span>
            <span class="n">parameters</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mf">3.6854</span> <span class="o">*</span> <span class="n">D</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">-</span> <span class="mf">1.4119</span> <span class="o">*</span> <span class="n">D</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mf">0.6312</span> <span class="o">*</span> <span class="n">D</span> <span class="o">-</span> <span class="mf">0.0043</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;poly_sinkF6P&#39;</span><span class="p">:</span>
            <span class="n">parameters</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span>
                <span class="mf">519.3740</span> <span class="o">*</span> <span class="n">D</span> <span class="o">**</span> <span class="mi">6</span> <span class="o">-</span> <span class="mf">447.7990</span> <span class="o">*</span> <span class="n">D</span> <span class="o">**</span> <span class="mi">5</span> <span class="o">+</span> <span class="mf">97.2843</span> <span class="o">*</span> <span class="n">D</span> <span class="o">**</span> <span class="mi">4</span> <span class="o">+</span> <span class="mf">8.0698</span> <span class="o">*</span> <span class="n">D</span> <span class="o">**</span> <span class="mi">3</span>
                <span class="o">-</span> <span class="mf">4.4005</span> <span class="o">*</span> <span class="n">D</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mf">0.6254</span> <span class="o">*</span> <span class="n">D</span> <span class="o">-</span> <span class="mf">0.0078</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;poly_sinkP3G&#39;</span><span class="p">:</span>
            <span class="n">parameters</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2381</span> <span class="o">*</span> <span class="n">D</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mf">0.0210</span> <span class="o">*</span> <span class="n">D</span> <span class="o">-</span> <span class="mf">0.0034</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;poly_sinkPEP&#39;</span><span class="p">:</span>
            <span class="n">parameters</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0637</span> <span class="o">*</span> <span class="n">D</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mf">0.0617</span> <span class="o">*</span> <span class="n">D</span> <span class="o">-</span> <span class="mf">0.0008</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;poly_sinkPYR&#39;</span><span class="p">:</span>
            <span class="n">parameters</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span>
                <span class="o">-</span><span class="mf">8.4853e03</span> <span class="o">*</span> <span class="n">D</span> <span class="o">**</span> <span class="mi">6</span> <span class="o">+</span> <span class="mf">9.4027e03</span> <span class="o">*</span> <span class="n">D</span> <span class="o">**</span> <span class="mi">5</span> <span class="o">-</span> <span class="mf">3.8027e03</span>
                <span class="o">*</span> <span class="n">D</span> <span class="o">**</span> <span class="mi">4</span> <span class="o">+</span> <span class="mf">700.5</span> <span class="o">*</span> <span class="n">D</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">-</span> <span class="mf">60.26</span> <span class="o">*</span> <span class="n">D</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mf">0.711</span> <span class="o">*</span> <span class="n">D</span> <span class="o">-</span> <span class="mf">0.0356</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;poly_sinkACE&#39;</span><span class="p">:</span>
            <span class="n">parameters</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span>
                <span class="mf">118.8562</span> <span class="o">*</span> <span class="n">D</span> <span class="o">**</span> <span class="mi">6</span> <span class="o">-</span> <span class="mf">352.3943</span> <span class="o">*</span> <span class="n">D</span> <span class="o">**</span> <span class="mi">5</span> <span class="o">+</span> <span class="mf">245.6092</span> <span class="o">*</span>
                <span class="n">D</span> <span class="o">**</span> <span class="mi">4</span> <span class="o">-</span> <span class="mf">75.2550</span> <span class="o">*</span> <span class="n">D</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">+</span> <span class="mf">11.1153</span> <span class="o">*</span> <span class="n">D</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mf">1.0379</span> <span class="o">*</span> <span class="n">D</span> <span class="o">+</span> <span class="mf">0.0119</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;ECbiomass&#39;</span><span class="p">:</span>
            <span class="n">parameters</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="mf">3.7683659</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;D&quot;</span><span class="p">:</span>
            <span class="n">parameters</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>

<span class="n">y0_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;ICG1P&quot;</span><span class="p">:</span> <span class="mf">0.064568</span><span class="p">,</span> <span class="s2">&quot;ICT6P&quot;</span><span class="p">:</span> <span class="mf">0.093705</span><span class="p">,</span> <span class="s2">&quot;ICtreh&quot;</span><span class="p">:</span> <span class="mf">63.312040</span><span class="p">,</span>
    <span class="s2">&quot;ICglucose&quot;</span><span class="p">:</span> <span class="mf">0.196003</span><span class="p">,</span> <span class="s2">&quot;ICG6P&quot;</span><span class="p">:</span> <span class="mf">0.716385</span><span class="p">,</span> <span class="s2">&quot;ICF6P&quot;</span><span class="p">:</span> <span class="mf">0.202293</span><span class="p">,</span>
    <span class="s2">&quot;ICFBP&quot;</span><span class="p">:</span> <span class="mf">0.057001</span><span class="p">,</span> <span class="s2">&quot;ICDHAP&quot;</span><span class="p">:</span> <span class="mf">0.048571</span><span class="p">,</span> <span class="s2">&quot;ICG3P&quot;</span><span class="p">:</span> <span class="mf">0.020586</span><span class="p">,</span>
    <span class="s2">&quot;ICglyc&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s2">&quot;ICGAP&quot;</span><span class="p">:</span> <span class="mf">0.006213</span><span class="p">,</span> <span class="s2">&quot;ICBPG&quot;</span><span class="p">:</span> <span class="mf">0.0001</span><span class="p">,</span>
    <span class="s2">&quot;IC3PG&quot;</span><span class="p">:</span> <span class="mf">2.311074</span><span class="p">,</span> <span class="s2">&quot;IC2PG&quot;</span><span class="p">:</span> <span class="mf">0.297534</span><span class="p">,</span> <span class="s2">&quot;ICPEP&quot;</span><span class="p">:</span> <span class="mf">1.171415</span><span class="p">,</span>
    <span class="s2">&quot;ICPYR&quot;</span><span class="p">:</span> <span class="mf">0.152195</span><span class="p">,</span> <span class="s2">&quot;ICACE&quot;</span><span class="p">:</span> <span class="mf">0.04</span><span class="p">,</span> <span class="s2">&quot;ICETOH&quot;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span>
    <span class="s2">&quot;ECETOH&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;ECglyc&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;ICNADH&quot;</span><span class="p">:</span> <span class="mf">0.0106</span><span class="p">,</span>
    <span class="s2">&quot;ICNAD&quot;</span><span class="p">:</span> <span class="mf">1.5794</span><span class="p">,</span> <span class="s2">&quot;ICATP&quot;</span><span class="p">:</span> <span class="mf">3.730584</span><span class="p">,</span> <span class="s2">&quot;ICADP&quot;</span><span class="p">:</span> <span class="mf">1.376832</span><span class="p">,</span>
    <span class="s2">&quot;ICAMP&quot;</span><span class="p">:</span> <span class="mf">0.431427</span><span class="p">,</span> <span class="s2">&quot;ICPHOS&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;ICIMP&quot;</span><span class="p">:</span> <span class="mf">0.100</span><span class="p">,</span> <span class="s2">&quot;ICINO&quot;</span><span class="p">:</span> <span class="mf">0.100</span><span class="p">,</span>
    <span class="s2">&quot;ICHYP&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span> <span class="p">}</span>

<span class="n">y0</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">meta</span> <span class="ow">in</span> <span class="n">kmodel</span><span class="o">.</span><span class="n">species_names</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">meta</span> <span class="ow">in</span> <span class="n">y0_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">y0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y0_dict</span><span class="p">[</span><span class="n">meta</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">meta</span><span class="p">)</span>
        <span class="n">y0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y0</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y0</span><span class="p">)</span>
</code></pre></div>

<h2 id="exporting-the-model">Exporting the model</h2>
<p>The model can be exported to sbml format for parameter optimziation. </p>
<div class="codehilite"><pre><span></span><code><span class="n">output_dir</span> <span class="o">=</span> <span class="s2">&quot;models/manual_implementations/sbml_export/&quot;</span>
<span class="n">model_name</span> <span class="o">=</span> <span class="s2">&quot;glycolysis_feastfamine_pulse1&quot;</span>

<span class="n">sbml</span> <span class="o">=</span> <span class="n">SBMLExporter</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">kmodel_sim</span><span class="p">)</span>

<span class="n">sbml</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">initial_conditions</span><span class="o">=</span><span class="n">y0</span><span class="p">,</span>
            <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span>
            <span class="n">output_file</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_dir</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2">.xml&quot;</span><span class="p">)</span>
</code></pre></div>

<h2 id="references">References</h2>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>Lao-Martil, D., Schmitz, J. P., Teusink, B., &amp; van Riel, N. A. (2023). Elucidating yeast glycolytic dynamics at steady state growth and glucose pulses through kinetic metabolic modeling. Metabolic engineering, 77, 128-142.&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../simulated-DBTL/" class="btn btn-neutral float-left" title="Simulated-DBTL"><span class="icon icon-circle-arrow-left"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../simulated-DBTL/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
