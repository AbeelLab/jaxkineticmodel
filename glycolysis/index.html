<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Custom models - jaxkineticmodel documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Custom models";
        var mkdocs_page_input_path = "glycolysis.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> jaxkineticmodel documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../building_models/">Building models</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../SBML/">Loading SBML models</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../training_models/">Training models</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../simulated-DBTL/">Simulated-DBTL</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Custom models</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#glycolysis-model">Glycolysis model</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#rate-laws">Rate laws</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#parameters">Parameters</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#custom-ode-system">Custom ODE system</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#parameterization">Parameterization</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#references">References</a>
    </li>
    </ul>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">jaxkineticmodel documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Custom models</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h2 id="custom-ode-models">Custom ODE models</h2>
<p>Not all kinetic model can be drafted only from stoichiometry. There are many empirical laws that might influence reactions in the system of ODEs. Below, we present a reimplemented version <strong>[1]</strong> of a glycolysis model in Jax with a manually set up of ODEs. </p>
<h3 id="glycolysis-model">Glycolysis model</h3>
<p>The model consists of 29 metabolites (ODEs), 38 reactions, with in total 141 parameters. The model can also be found in <a href="https://github.com/AbeelLab/jaxkineticmodel/tree/main/models/manual_implementations/glycolysis">Github/models/manual_implementations</a> and loaded from there.</p>
<h4 id="rate-laws">Rate laws</h4>
<p>Start by loading the required kinetic mechanisms</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">jaxkineticmodel.kinetic_mechanisms.JaxKineticMechanisms</span> <span class="kn">import</span>  <span class="o">*</span>
<span class="kn">from</span> <span class="nn">jaxkineticmodel.kinetic_mechanisms.JaxKineticMechanismsCustom</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">jaxkineticmodel.kinetic_mechanisms.JaxKineticModifiers</span> <span class="kn">import</span> <span class="o">*</span>
</code></pre></div>

<p>Now, we define all reactions in the model. Note that names in substrates and products should match actual species names in the initial conditions. First, lower glycolysis.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">#upper glycolysis (GLT, HXK, PGI, PFK,ALD,TPI)</span>
<span class="n">v_GLT</span><span class="o">=</span><span class="n">Jax_Facilitated_Diffusion</span><span class="p">(</span><span class="n">substrate_extracellular</span><span class="o">=</span><span class="s1">&#39;ECglucose&#39;</span><span class="p">,</span><span class="n">product_intracellular</span><span class="o">=</span><span class="s1">&#39;ICglucose&#39;</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_GLT_VmGLT&quot;</span><span class="p">,</span><span class="n">km_internal</span><span class="o">=</span><span class="s1">&#39;p_GLT_KmGLTGLCi&#39;</span><span class="p">,</span><span class="n">km_external</span><span class="o">=</span><span class="s1">&#39;p_GLT_KmGLTGLCo&#39;</span><span class="p">)</span>

<span class="n">v_HXK</span><span class="o">=</span><span class="n">Jax_MM_Rev_BiBi_w_Inhibition</span><span class="p">(</span><span class="n">substrate1</span><span class="o">=</span><span class="s1">&#39;ICATP&#39;</span><span class="p">,</span><span class="n">substrate2</span><span class="o">=</span><span class="s2">&quot;ICglucose&quot;</span><span class="p">,</span><span class="n">product1</span><span class="o">=</span><span class="s2">&quot;ICADP&quot;</span><span class="p">,</span><span class="n">product2</span><span class="o">=</span><span class="s2">&quot;ICATP&quot;</span><span class="p">,</span><span class="n">modifier</span><span class="o">=</span><span class="s2">&quot;ICT6P&quot;</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_HXK_Vmax&quot;</span><span class="p">,</span> <span class="n">k_equilibrium</span><span class="o">=</span><span class="s2">&quot;p_HXK1_Keq&quot;</span><span class="p">,</span> <span class="n">km_substrate1</span><span class="o">=</span><span class="s2">&quot;p_HXK1_Katp&quot;</span><span class="p">,</span> 
                                           <span class="n">km_substrate2</span><span class="o">=</span><span class="s2">&quot;p_HXK1_Kglc&quot;</span><span class="p">,</span>
                                           <span class="n">km_product1</span><span class="o">=</span><span class="s2">&quot;p_HXK1_Kadp&quot;</span><span class="p">,</span> <span class="n">km_product2</span><span class="o">=</span><span class="s2">&quot;p_HXK1_Kg6p&quot;</span><span class="p">,</span> <span class="n">ki_inhibitor</span><span class="o">=</span><span class="s2">&quot;p_HXK1_Kt6p&quot;</span><span class="p">)</span>
<span class="n">v_PGI</span><span class="o">=</span><span class="n">Jax_MM_Rev_UniUni</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s1">&#39;ICG6P&#39;</span><span class="p">,</span><span class="n">product</span><span class="o">=</span><span class="s1">&#39;ICF6P&#39;</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="s1">&#39;p_PGI1_Vmax&#39;</span><span class="p">,</span><span class="n">k_equilibrium</span><span class="o">=</span><span class="s1">&#39;p_PGI1_Keq&#39;</span><span class="p">,</span><span class="n">km_substrate</span><span class="o">=</span><span class="s1">&#39;p_PGI1_Kg6p&#39;</span><span class="p">,</span><span class="n">km_product</span><span class="o">=</span><span class="s1">&#39;p_PGI1_Kf6p&#39;</span><span class="p">)</span>


<span class="n">v_PFK</span><span class="o">=</span><span class="n">Jax_PFK</span><span class="p">(</span><span class="n">substrate1</span><span class="o">=</span><span class="s2">&quot;ICF6P&quot;</span><span class="p">,</span><span class="n">substrate2</span><span class="o">=</span><span class="s2">&quot;ICATP&quot;</span><span class="p">,</span><span class="n">product1</span><span class="o">=</span><span class="s2">&quot;ICFBP&quot;</span><span class="p">,</span><span class="n">modifier</span><span class="o">=</span><span class="s2">&quot;ICAMP&quot;</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_PFK_Vmax&quot;</span><span class="p">,</span><span class="n">kr_F6P</span><span class="o">=</span><span class="s2">&quot;p_PFK_Kf6p&quot;</span><span class="p">,</span> <span class="n">kr_ATP</span><span class="o">=</span><span class="s2">&quot;p_PFK_Katp&quot;</span><span class="p">,</span> <span class="n">gr</span><span class="o">=</span><span class="s2">&quot;p_PFK_gR&quot;</span><span class="p">,</span><span class="n">c_ATP</span><span class="o">=</span><span class="s2">&quot;p_PFK_Catp&quot;</span><span class="p">,</span> <span class="n">ci_ATP</span><span class="o">=</span><span class="s2">&quot;p_PFK_Ciatp&quot;</span><span class="p">,</span> <span class="n">ci_AMP</span><span class="o">=</span><span class="s2">&quot;p_PFK_Camp&quot;</span><span class="p">,</span> 
                           <span class="n">ci_F26BP</span><span class="o">=</span><span class="s2">&quot;p_PFK_Cf26bp&quot;</span><span class="p">,</span> <span class="n">ci_F16BP</span><span class="o">=</span><span class="s2">&quot;p_PFK_Cf16bp&quot;</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="s2">&quot;p_PFK_L&quot;</span><span class="p">,</span> 
                           <span class="n">kATP</span><span class="o">=</span><span class="s2">&quot;p_PFK_Kiatp&quot;</span><span class="p">,</span> <span class="n">kAMP</span><span class="o">=</span><span class="s2">&quot;p_PFK_Kamp&quot;</span><span class="p">,</span> <span class="n">F26BP</span> <span class="o">=</span><span class="s2">&quot;p_PFK_F26BP&quot;</span><span class="p">,</span>
                           <span class="n">kF26BP</span> <span class="o">=</span> <span class="s2">&quot;p_PFK_Kf26bp&quot;</span><span class="p">,</span> <span class="n">kF16BP</span> <span class="o">=</span> <span class="s2">&quot;p_PFK_Kf16bp&quot;</span><span class="p">)</span>
<span class="n">v_ALD</span><span class="o">=</span><span class="n">Jax_MM_Rev_UniBi</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s1">&#39;ICFBP&#39;</span><span class="p">,</span><span class="n">product1</span><span class="o">=</span><span class="s1">&#39;ICGAP&#39;</span><span class="p">,</span><span class="n">product2</span><span class="o">=</span><span class="s1">&#39;ICDHAP&#39;</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_FBA1_Vmax&quot;</span><span class="p">,</span> <span class="n">k_equilibrium</span><span class="o">=</span><span class="s2">&quot;p_FBA1_Keq&quot;</span><span class="p">,</span> <span class="n">km_substrate</span><span class="o">=</span><span class="s2">&quot;p_FBA1_Kf16bp&quot;</span><span class="p">,</span>
                                    <span class="n">km_product1</span><span class="o">=</span><span class="s2">&quot;p_FBA1_Kglyceral3p&quot;</span><span class="p">,</span> <span class="n">km_product2</span><span class="o">=</span><span class="s2">&quot;p_FBA1_Kdhap&quot;</span> <span class="p">)</span>
<span class="n">v_TPI1</span><span class="o">=</span><span class="n">Jax_MM_Rev_UniUni</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICDHAP&quot;</span><span class="p">,</span><span class="n">product</span><span class="o">=</span><span class="s2">&quot;ICGAP&quot;</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_TPI1_Vmax&quot;</span><span class="p">,</span><span class="n">k_equilibrium</span><span class="o">=</span><span class="s2">&quot;p_TPI1_Keq&quot;</span><span class="p">,</span> <span class="n">km_substrate</span><span class="o">=</span><span class="s2">&quot;p_TPI1_Kdhap&quot;</span><span class="p">,</span>
                                <span class="n">km_product</span><span class="o">=</span><span class="s2">&quot;p_TPI1_Kglyceral3p&quot;</span><span class="p">)</span>
</code></pre></div>

<p>Trehalose cycle</p>
<div class="codehilite"><pre><span></span><code><span class="c1">#trehalose cycle (NTH1, PGM1, TPS2, TPS1)</span>
<span class="n">v_NTH1</span><span class="o">=</span><span class="n">Jax_MM_Irrev_Uni</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s1">&#39;ICtreh&#39;</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="s1">&#39;p_NTH1_Vmax&#39;</span><span class="p">,</span><span class="n">km_substrate</span><span class="o">=</span><span class="s1">&#39;p_NTH1_Ktre&#39;</span><span class="p">)</span>


<span class="n">v_PGM1</span><span class="o">=</span><span class="n">Jax_MM_Rev_UniUni</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s1">&#39;ICG1P&#39;</span><span class="p">,</span><span class="n">product</span><span class="o">=</span><span class="s1">&#39;ICG6P&#39;</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="s1">&#39;p_PGM1_Vmax&#39;</span><span class="p">,</span><span class="n">k_equilibrium</span><span class="o">=</span><span class="s1">&#39;p_PGM1_Keq&#39;</span><span class="p">,</span><span class="n">km_substrate</span><span class="o">=</span><span class="s1">&#39;p_PGM1_Kg1p&#39;</span><span class="p">,</span><span class="n">km_product</span><span class="o">=</span><span class="s1">&#39;p_PGM1_Kg6p&#39;</span><span class="p">)</span> <span class="c1">#to do v_TPS1 for 2nd rate law</span>

<span class="c1"># inhibitor_TPS1=SimpleInhibitor(k_I=&#39;p_TPS1_Kpi&#39;)</span>
<span class="n">activator_TPS1</span><span class="o">=</span><span class="n">SimpleActivator</span><span class="p">(</span><span class="n">k_A</span><span class="o">=</span><span class="s2">&quot;p_TPS1_KmF6P&quot;</span><span class="p">)</span>
<span class="n">v_TPS1</span><span class="o">=</span><span class="n">Jax_MM_Irrev_Bi_w_Modifiers</span><span class="p">(</span><span class="n">substrate1</span><span class="o">=</span><span class="s2">&quot;ICG6P&quot;</span><span class="p">,</span><span class="n">substrate2</span><span class="o">=</span><span class="s2">&quot;ICG1P&quot;</span><span class="p">,</span><span class="n">modifiers_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICF6P&#39;</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_TPS1_Vmax&quot;</span><span class="p">,</span><span class="n">km_substrate1</span><span class="o">=</span><span class="s2">&quot;p_TPS1_Kg6p&quot;</span><span class="p">,</span>
                                  <span class="n">km_substrate2</span><span class="o">=</span><span class="s2">&quot;p_TPS1_Kudp_glc&quot;</span><span class="p">,</span><span class="n">modifiers</span><span class="o">=</span><span class="p">[</span><span class="n">activator_TPS1</span><span class="p">])</span>

<span class="c1"># v_TPS1=Jax_MM_Irrev_Bi(substrate1=&quot;ICG6P&quot;,substrate2=&quot;ICG1P&quot;,vmax=&quot;p_TPS1_Vmax&quot;,km_substrate1=&quot;p_TPS1_Kg6p&quot;,km_substrate2=&quot;p_TPS1_Kudp_glc&quot;)</span>
<span class="n">v_TPS2</span><span class="o">=</span><span class="n">Jax_MM_Irrev_Bi_w_Inhibition</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICT6P&quot;</span><span class="p">,</span><span class="n">product</span><span class="o">=</span><span class="s2">&quot;ICPHOS&quot;</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_TPS2_Vmax&quot;</span><span class="p">,</span> <span class="n">km_substrate1</span><span class="o">=</span><span class="s2">&quot;p_TPS2_Kt6p&quot;</span><span class="p">,</span> <span class="n">ki</span><span class="o">=</span><span class="s2">&quot;p_TPS2_Kpi&quot;</span><span class="p">)</span>
</code></pre></div>

<p>Lower glycolysis</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Lower glycolysis (GAPDH, PGK,PGM,ENO, PDC, ADH)</span>
<span class="n">v_GAPDH</span><span class="o">=</span><span class="n">Jax_MM_Ordered_Bi_Tri</span><span class="p">(</span><span class="n">substrate1</span><span class="o">=</span><span class="s2">&quot;ICGAP&quot;</span><span class="p">,</span><span class="n">substrate2</span><span class="o">=</span><span class="s2">&quot;ICNAD&quot;</span><span class="p">,</span><span class="n">substrate3</span><span class="o">=</span><span class="s2">&quot;ICPHOS&quot;</span><span class="p">,</span><span class="n">product1</span><span class="o">=</span><span class="s2">&quot;ICBPG&quot;</span><span class="p">,</span><span class="n">product2</span><span class="o">=</span><span class="s2">&quot;ICNADH&quot;</span><span class="p">,</span>
                              <span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_GAPDH_Vmax&quot;</span><span class="p">,</span> <span class="n">k_equilibrium</span><span class="o">=</span><span class="s2">&quot;p_TDH1_Keq&quot;</span><span class="p">,</span> <span class="n">km_substrate1</span><span class="o">=</span><span class="s2">&quot;p_TDH1_Kglyceral3p&quot;</span><span class="p">,</span>
                                      <span class="n">km_substrate2</span><span class="o">=</span><span class="s2">&quot;p_TDH1_Knad&quot;</span><span class="p">,</span> <span class="n">ki</span><span class="o">=</span><span class="s2">&quot;p_TDH1_Kpi&quot;</span><span class="p">,</span> 
                                      <span class="n">km_product1</span><span class="o">=</span><span class="s2">&quot;p_TDH1_Kglycerate13bp&quot;</span><span class="p">,</span> <span class="n">km_product2</span><span class="o">=</span><span class="s2">&quot;p_TDH1_Knadh&quot;</span><span class="p">)</span> <span class="c1">#might exchange this mechanism by a BiBi mechanism, since modeling Phos is a bit too much</span>
<span class="n">v_PGK</span><span class="o">=</span><span class="n">Jax_MM_Rev_BiBi</span><span class="p">(</span><span class="n">substrate1</span><span class="o">=</span><span class="s2">&quot;ICBPG&quot;</span><span class="p">,</span><span class="n">substrate2</span><span class="o">=</span><span class="s2">&quot;ICADP&quot;</span><span class="p">,</span><span class="n">product1</span><span class="o">=</span><span class="s2">&quot;IC3PG&quot;</span><span class="p">,</span><span class="n">product2</span><span class="o">=</span><span class="s2">&quot;ICATP&quot;</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_PGK_VmPGK&quot;</span><span class="p">,</span><span class="n">k_equilibrium</span><span class="o">=</span><span class="s2">&quot;p_PGK_KeqPGK&quot;</span><span class="p">,</span> 
                               <span class="n">km_substrate1</span><span class="o">=</span><span class="s2">&quot;p_PGK_KmPGKBPG&quot;</span><span class="p">,</span> <span class="n">km_substrate2</span><span class="o">=</span><span class="s2">&quot;p_PGK_KmPGKADP&quot;</span><span class="p">,</span> 
                               <span class="n">km_product1</span><span class="o">=</span><span class="s2">&quot;p_PGK_KmPGKP3G&quot;</span><span class="p">,</span> <span class="n">km_product2</span><span class="o">=</span><span class="s2">&quot;p_PGK_KmPGKATP&quot;</span><span class="p">)</span>
<span class="n">v_PGM</span><span class="o">=</span><span class="n">Jax_MM_Rev_UniUni</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;IC3PG&quot;</span><span class="p">,</span><span class="n">product</span><span class="o">=</span><span class="s2">&quot;IC2PG&quot;</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_PGM_Vm&quot;</span><span class="p">,</span> <span class="n">k_equilibrium</span><span class="o">=</span><span class="s2">&quot;p_PGM_Keq&quot;</span><span class="p">,</span>
                                 <span class="n">km_substrate</span><span class="o">=</span><span class="s2">&quot;p_PGM_K3pg&quot;</span><span class="p">,</span> <span class="n">km_product</span><span class="o">=</span><span class="s2">&quot;p_PGM_K2pg&quot;</span><span class="p">)</span>
<span class="n">v_ENO</span><span class="o">=</span><span class="n">Jax_MM_Rev_UniUni</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;IC2PG&quot;</span><span class="p">,</span><span class="n">product</span><span class="o">=</span><span class="s2">&quot;ICPEP&quot;</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_ENO1_Vm&quot;</span><span class="p">,</span><span class="n">k_equilibrium</span><span class="o">=</span><span class="s2">&quot;p_ENO1_Keq&quot;</span><span class="p">,</span>
                                <span class="n">km_substrate</span><span class="o">=</span><span class="s2">&quot;p_ENO1_K2pg&quot;</span><span class="p">,</span> <span class="n">km_product</span><span class="o">=</span><span class="s2">&quot;p_ENO1_Kpep&quot;</span><span class="p">)</span> 
<span class="n">v_PYK1</span><span class="o">=</span><span class="n">Jax_Hill_Irreversible_Bi_Activation</span><span class="p">(</span><span class="n">substrate1</span><span class="o">=</span><span class="s2">&quot;ICPEP&quot;</span><span class="p">,</span><span class="n">substrate2</span><span class="o">=</span><span class="s2">&quot;ICADP&quot;</span><span class="p">,</span><span class="n">activator</span><span class="o">=</span><span class="s2">&quot;ICFBP&quot;</span><span class="p">,</span><span class="n">product</span><span class="o">=</span><span class="s2">&quot;ICATP&quot;</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_PYK1_Vm&quot;</span><span class="p">,</span> <span class="n">hill</span><span class="o">=</span><span class="s2">&quot;p_PYK1_hill&quot;</span><span class="p">,</span>
                                                  <span class="n">k_substrate1</span><span class="o">=</span><span class="s2">&quot;p_PYK1_Kpep&quot;</span><span class="p">,</span> <span class="n">k_substrate2</span><span class="o">=</span><span class="s2">&quot;p_PYK1_Kadp&quot;</span><span class="p">,</span>
                                                  <span class="n">k_product</span><span class="o">=</span><span class="s2">&quot;p_PYK1_Katp&quot;</span><span class="p">,</span> <span class="n">k_activator</span><span class="o">=</span><span class="s2">&quot;p_PYK1_Kf16bp&quot;</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="s2">&quot;p_PYK1_L&quot;</span><span class="p">)</span>                                                                                  
<span class="n">v_PDC</span><span class="o">=</span><span class="n">Jax_Hill_Irreversible_Inhibition</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICPYR&quot;</span><span class="p">,</span><span class="n">inhibitor</span><span class="o">=</span><span class="s2">&quot;ICPHOS&quot;</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_PDC1_Vmax&quot;</span><span class="p">,</span><span class="n">k_half_substrate</span><span class="o">=</span><span class="s2">&quot;p_PDC1_Kpyr&quot;</span><span class="p">,</span>
                                               <span class="n">hill</span><span class="o">=</span><span class="s2">&quot;p_PDC1_hill&quot;</span><span class="p">,</span> <span class="n">ki</span><span class="o">=</span><span class="s2">&quot;p_PDC1_Kpi&quot;</span><span class="p">)</span>
<span class="n">v_ADH</span> <span class="o">=</span> <span class="n">Jax_ADH</span><span class="p">(</span><span class="n">NAD</span><span class="o">=</span><span class="s2">&quot;ICNAD&quot;</span><span class="p">,</span><span class="n">ETOH</span><span class="o">=</span><span class="s2">&quot;ICETOH&quot;</span><span class="p">,</span><span class="n">NADH</span><span class="o">=</span><span class="s2">&quot;ICNADH&quot;</span><span class="p">,</span><span class="n">ACE</span><span class="o">=</span><span class="s2">&quot;ICACE&quot;</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="s1">&#39;p_ADH_VmADH&#39;</span><span class="p">,</span>
    <span class="n">k_equilibrium</span><span class="o">=</span><span class="s1">&#39;p_ADH_KeqADH&#39;</span><span class="p">,</span><span class="n">km_substrate1</span><span class="o">=</span><span class="s1">&#39;p_ADH_KiADHNAD&#39;</span><span class="p">,</span>
    <span class="n">km_substrate2</span><span class="o">=</span><span class="s1">&#39;p_ADH_KmADHETOH&#39;</span><span class="p">,</span><span class="n">km_product1</span><span class="o">=</span><span class="s1">&#39;p_ADH_KmADHACE&#39;</span><span class="p">,</span>
    <span class="n">km_product2</span><span class="o">=</span><span class="s1">&#39;p_ADH_KmADHNADH&#39;</span><span class="p">,</span><span class="n">ki_substrate1</span><span class="o">=</span><span class="s1">&#39;p_ADH_KiADHNAD&#39;</span><span class="p">,</span>
    <span class="n">ki_substrate2</span><span class="o">=</span><span class="s1">&#39;p_ADH_KiADHETOH&#39;</span><span class="p">,</span><span class="n">ki_product1</span><span class="o">=</span><span class="s1">&#39;p_ADH_KiADHACE&#39;</span><span class="p">,</span>
    <span class="n">ki_product2</span><span class="o">=</span><span class="s1">&#39;p_ADH_KiADHNADH&#39;</span><span class="p">,</span><span class="n">exprs_cor</span><span class="o">=</span><span class="s2">&quot;p_ADH_ExprsCor&quot;</span><span class="p">)</span>

<span class="n">v_EtohT</span> <span class="o">=</span> <span class="n">Jax_Diffusion</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICETOH&quot;</span><span class="p">,</span><span class="n">enzyme</span><span class="o">=</span><span class="s2">&quot;f_ETOH_e&quot;</span><span class="p">,</span> <span class="n">transport_coef</span><span class="o">=</span><span class="s2">&quot;p_kETOHtransport&quot;</span><span class="p">)</span>
</code></pre></div>

<p>Glycerophospholipid pathway</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Glycerophospholipid (G3PDH, HOR2, GlycTransport)</span>
<span class="n">HOR2_inhibition_Pi</span><span class="o">=</span><span class="n">SimpleInhibitor</span><span class="p">(</span><span class="n">k_I</span><span class="o">=</span><span class="s2">&quot;p_HOR2_Kpi&quot;</span><span class="p">)</span>
<span class="n">v_HOR2</span><span class="o">=</span><span class="n">Jax_MM_Irrev_Uni_w_Modifiers</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICG3P&quot;</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_HOR2_Vmax&quot;</span><span class="p">,</span><span class="n">km_substrate</span><span class="o">=</span><span class="s2">&quot;p_HOR2_Kglyc3p&quot;</span><span class="p">,</span><span class="n">modifiers_list</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ICPHOS&quot;</span><span class="p">],</span><span class="n">modifiers</span><span class="o">=</span><span class="p">[</span><span class="n">HOR2_inhibition_Pi</span><span class="p">])</span>
<span class="n">v_GlycT</span><span class="o">=</span><span class="n">Jax_Diffusion</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICglyc&quot;</span><span class="p">,</span><span class="n">enzyme</span><span class="o">=</span><span class="s2">&quot;f_GLYCEROL_e&quot;</span><span class="p">,</span><span class="n">transport_coef</span><span class="o">=</span><span class="s2">&quot;p_GlycerolTransport&quot;</span><span class="p">)</span>

<span class="n">v_G3PDH</span><span class="o">=</span><span class="n">Jax_MM_Rev_BiBi_w_Activation</span><span class="p">(</span><span class="n">substrate1</span><span class="o">=</span><span class="s2">&quot;ICDHAP&quot;</span><span class="p">,</span><span class="n">substrate2</span><span class="o">=</span><span class="s2">&quot;ICNADH&quot;</span><span class="p">,</span><span class="n">product1</span><span class="o">=</span><span class="s2">&quot;ICG3P&quot;</span><span class="p">,</span><span class="n">product2</span><span class="o">=</span><span class="s2">&quot;ICNAD&quot;</span><span class="p">,</span><span class="n">modifiers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ICFBP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICATP&#39;</span><span class="p">,</span> <span class="s1">&#39;ICADP&#39;</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_GPD1_Vmax&quot;</span><span class="p">,</span> <span class="n">k_equilibrium</span><span class="o">=</span><span class="s2">&quot;p_GPD1_Keq&quot;</span><span class="p">,</span> 
                                             <span class="n">km_substrate1</span><span class="o">=</span><span class="s2">&quot;p_GPD1_Kdhap&quot;</span><span class="p">,</span> <span class="n">km_substrate2</span><span class="o">=</span><span class="s2">&quot;p_GPD1_Knadh&quot;</span><span class="p">,</span>
                                             <span class="n">km_product1</span><span class="o">=</span><span class="s2">&quot;p_GPD1_Kglyc3p&quot;</span><span class="p">,</span> <span class="n">km_product2</span><span class="o">=</span><span class="s2">&quot;p_GPD1_Knad&quot;</span><span class="p">,</span>
                                               <span class="n">ka1</span><span class="o">=</span><span class="s2">&quot;p_GPD1_Kf16bp&quot;</span><span class="p">,</span> <span class="n">ka2</span><span class="o">=</span><span class="s2">&quot;p_GPD1_Katp&quot;</span><span class="p">,</span> <span class="n">ka3</span><span class="o">=</span><span class="s2">&quot;p_GPD1_Kadp&quot;</span><span class="p">)</span>
</code></pre></div>

<p>Cofactor metabolism</p>
<div class="codehilite"><pre><span></span><code><span class="n">v_mitoNADH</span><span class="o">=</span><span class="n">Jax_MM</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICNADH&quot;</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_mitoNADHVmax&quot;</span><span class="p">,</span><span class="n">km</span><span class="o">=</span><span class="s2">&quot;p_mitoNADHKm&quot;</span><span class="p">)</span> <span class="c1">#I think this can be replaced by Jax_MM_Irrev_Uni</span>
<span class="n">v_ATPmito</span><span class="o">=</span><span class="n">Jax_MM_Irrev_Bi</span><span class="p">(</span><span class="s2">&quot;ICADP&quot;</span><span class="p">,</span><span class="s2">&quot;ICPHOS&quot;</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_mitoVmax&quot;</span><span class="p">,</span><span class="n">km_substrate1</span><span class="o">=</span><span class="s2">&quot;p_mitoADPKm&quot;</span><span class="p">,</span>
                                  <span class="n">km_substrate2</span><span class="o">=</span><span class="s2">&quot;p_mitoPiKm&quot;</span><span class="p">)</span>
<span class="n">v_ATPase</span><span class="o">=</span><span class="n">Jax_ATPase</span><span class="p">(</span><span class="s2">&quot;ICATP&quot;</span><span class="p">,</span><span class="s2">&quot;ICADP&quot;</span><span class="p">,</span><span class="n">ATPase_ratio</span><span class="o">=</span><span class="s2">&quot;p_ATPase_ratio&quot;</span><span class="p">)</span>
<span class="n">v_ADK</span><span class="o">=</span><span class="n">Jax_MA_Rev_Bi</span><span class="p">(</span><span class="n">substrate1</span><span class="o">=</span><span class="s2">&quot;ICADP&quot;</span><span class="p">,</span><span class="n">substrate2</span><span class="o">=</span><span class="s2">&quot;ICADP&quot;</span><span class="p">,</span><span class="n">product1</span><span class="o">=</span><span class="s2">&quot;ICATP&quot;</span><span class="p">,</span><span class="n">product2</span><span class="o">=</span><span class="s2">&quot;ICAMP&quot;</span><span class="p">,</span><span class="n">k_equilibrium</span><span class="o">=</span><span class="s2">&quot;p_ADK1_Keq&quot;</span><span class="p">,</span><span class="n">k_fwd</span><span class="o">=</span><span class="s2">&quot;p_ADK1_k&quot;</span><span class="p">)</span>
<span class="n">v_VacPi</span><span class="o">=</span><span class="n">Jax_MA_Rev</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICPHOS&quot;</span><span class="p">,</span><span class="n">k</span><span class="o">=</span><span class="s2">&quot;p_vacuolePi_k&quot;</span><span class="p">,</span><span class="n">steady_state_substrate</span><span class="o">=</span><span class="s2">&quot;p_vacuolePi_steadyStatePi&quot;</span><span class="p">)</span>
<span class="n">v_AMD1</span><span class="o">=</span><span class="n">Jax_Amd1</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICAMP&quot;</span><span class="p">,</span><span class="n">product</span><span class="o">=</span><span class="s2">&quot;ICATP&quot;</span><span class="p">,</span><span class="n">modifier</span><span class="o">=</span><span class="s2">&quot;ICPHOS&quot;</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="s2">&quot;p_Amd1_Vmax&quot;</span><span class="p">,</span> <span class="n">k50</span><span class="o">=</span><span class="s2">&quot;p_Amd1_K50&quot;</span><span class="p">,</span> <span class="n">ki</span><span class="o">=</span><span class="s2">&quot;p_Amd1_Kpi&quot;</span><span class="p">,</span> <span class="n">k_atp</span><span class="o">=</span><span class="s2">&quot;p_Amd1_Katp&quot;</span><span class="p">)</span>
<span class="n">v_ADE1312</span><span class="o">=</span><span class="n">Jax_MA_Irrev</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICIMP&quot;</span><span class="p">,</span><span class="n">k_fwd</span><span class="o">=</span><span class="s2">&quot;p_Ade13_Ade12_k&quot;</span><span class="p">)</span>

<span class="n">v_ISN1</span><span class="o">=</span><span class="n">Jax_MA_Irrev</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICIMP&quot;</span><span class="p">,</span><span class="n">k_fwd</span><span class="o">=</span><span class="s2">&quot;p_Isn1_k&quot;</span><span class="p">)</span>
<span class="n">v_PNP1</span><span class="o">=</span><span class="n">Jax_MA_Irrev</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICINO&quot;</span><span class="p">,</span><span class="n">k_fwd</span><span class="o">=</span><span class="s2">&quot;p_Pnp1_k&quot;</span><span class="p">)</span>
<span class="n">v_HPT1</span><span class="o">=</span><span class="n">Jax_MA_Irrev</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICHYP&quot;</span><span class="p">,</span><span class="n">k_fwd</span><span class="o">=</span><span class="s2">&quot;p_Hpt1_k&quot;</span><span class="p">)</span>
</code></pre></div>

<p>Sink reactions are required due to the fact metabolism is only partially modeled.</p>
<div class="codehilite"><pre><span></span><code><span class="n">v_sinkG6P</span><span class="o">=</span><span class="n">Jax_MM_Sink</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s1">&#39;ICG6P&#39;</span><span class="p">,</span><span class="n">v_sink</span><span class="o">=</span><span class="s1">&#39;poly_sinkG6P&#39;</span><span class="p">,</span><span class="n">km_sink</span><span class="o">=</span><span class="s1">&#39;km_sinkG6P&#39;</span><span class="p">)</span>
<span class="n">v_sinkF6P</span><span class="o">=</span><span class="n">Jax_MM_Sink</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s1">&#39;ICF6P&#39;</span><span class="p">,</span><span class="n">v_sink</span><span class="o">=</span><span class="s1">&#39;poly_sinkF6P&#39;</span><span class="p">,</span><span class="n">km_sink</span><span class="o">=</span><span class="s1">&#39;km_sinkF6P&#39;</span><span class="p">)</span>
<span class="n">v_sinkGAP</span><span class="o">=</span><span class="n">Jax_MM_Sink</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICGAP&quot;</span><span class="p">,</span><span class="n">v_sink</span><span class="o">=</span><span class="s2">&quot;poly_sinkGAP&quot;</span><span class="p">,</span><span class="n">km_sink</span><span class="o">=</span><span class="s2">&quot;km_sinkGAP&quot;</span><span class="p">)</span>
<span class="n">vsink3PGA</span><span class="o">=</span><span class="n">Jax_MM_Sink</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s1">&#39;IC3PG&#39;</span><span class="p">,</span><span class="n">v_sink</span><span class="o">=</span><span class="s1">&#39;poly_sinkP3G&#39;</span><span class="p">,</span><span class="n">km_sink</span><span class="o">=</span><span class="s1">&#39;km_sinkP3G&#39;</span><span class="p">)</span>
<span class="n">vsinkACE</span><span class="o">=</span><span class="n">Jax_MM_Sink</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICACE&quot;</span><span class="p">,</span><span class="n">v_sink</span><span class="o">=</span><span class="s2">&quot;poly_sinkACE&quot;</span><span class="p">,</span><span class="n">km_sink</span><span class="o">=</span><span class="s2">&quot;km_sinkACE&quot;</span><span class="p">)</span>
<span class="n">vsinkPYR</span><span class="o">=</span><span class="n">Jax_MM_Sink</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICPYR&quot;</span><span class="p">,</span><span class="n">v_sink</span><span class="o">=</span><span class="s2">&quot;poly_sinkPYR&quot;</span><span class="p">,</span> <span class="n">km_sink</span><span class="o">=</span><span class="s2">&quot;km_sinkPYR&quot;</span><span class="p">)</span>
<span class="n">vsinkPEP</span> <span class="o">=</span> <span class="n">Jax_MM_Sink</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="s2">&quot;ICPEP&quot;</span><span class="p">,</span><span class="n">v_sink</span><span class="o">=</span><span class="s2">&quot;poly_sinkPEP&quot;</span><span class="p">,</span> <span class="n">km_sink</span><span class="o">=</span><span class="s2">&quot;km_sinkPEP&quot;</span><span class="p">)</span> <span class="c1">#reverse sign in stoichiometry</span>
</code></pre></div>

<h4 id="parameters">Parameters</h4>
<p>After defining all reactions, we load the parameter set that fitted the data in <strong>[2]</strong>. The trained parameters are here given below, but can also be found in the results directory.</p>
<p>TODO: make an online results directory that can be viewed.</p>
<h4 id="custom-ode-system">Custom ODE system</h4>
<p>We can now set up the ODE system, but note that it is not an ODE purely based on stoichiometry. The points in the ODEs where it is not purely stoichiometric are denoted with a <code>##!!</code></p>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">glycolysis</span><span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                  <span class="n">interpolate_dict</span><span class="p">:</span><span class="nb">dict</span><span class="p">,</span>

                  <span class="n">met_names</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span>
                  <span class="n">dilution_rate</span><span class="p">:</span><span class="nb">float</span><span class="p">):</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">interpolate_dict</span><span class="o">=</span><span class="n">interpolate_dict</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">met_names</span><span class="o">=</span><span class="n">met_names</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">dilution_rate</span><span class="o">=</span><span class="n">dilution_rate</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">ECbiomass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">interpolate_dict</span><span class="p">[</span><span class="s1">&#39;ECbiomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">dilution_rate</span><span class="p">)</span>


    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">args</span><span class="p">):</span>
        <span class="n">params</span><span class="o">=</span><span class="n">args</span>
        <span class="n">y</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">met_names</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>

        <span class="c1">##!!</span>
        <span class="n">D</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dilution_rate</span> <span class="c1">#dilution rate. In steady state D=mu        </span>
        <span class="n">y</span><span class="p">[</span><span class="s1">&#39;ECglucose&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">interpolate_dict</span><span class="p">[</span><span class="s1">&#39;ECglucose&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="c1">##!!</span>
        <span class="n">eval_dict</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">y</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">}</span>



        <span class="c1">#poly_sink parameters are defined based on a dilution rate dependency, which is an argument to the model</span>

        <span class="n">eval_dict</span><span class="p">[</span><span class="s1">&#39;poly_sinkG6P&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mf">3.6854</span> <span class="o">*</span> <span class="n">D</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span>   <span class="mf">1.4119</span> <span class="o">*</span> <span class="n">D</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>  <span class="mf">0.6312</span><span class="o">*</span> <span class="n">D</span>    <span class="o">-</span> <span class="mf">0.0043</span><span class="p">)</span> 
        <span class="n">eval_dict</span><span class="p">[</span><span class="s1">&#39;poly_sinkF6P&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mf">519.3740</span> <span class="o">*</span> <span class="n">D</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mf">447.7990</span> <span class="o">*</span> <span class="n">D</span><span class="o">**</span><span class="mi">5</span> <span class="o">+</span> <span class="mf">97.2843</span> <span class="o">*</span> <span class="n">D</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mf">8.0698</span> <span class="o">*</span> <span class="n">D</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mf">4.4005</span> <span class="o">*</span> <span class="n">D</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.6254</span> <span class="o">*</span> <span class="n">D</span> <span class="o">-</span> <span class="mf">0.0078</span><span class="p">)</span>
        <span class="n">eval_dict</span><span class="p">[</span><span class="s1">&#39;poly_sinkGAP&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mf">170.8447</span> <span class="o">*</span> <span class="n">D</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mf">113.2975</span> <span class="o">*</span> <span class="n">D</span><span class="o">**</span><span class="mi">5</span> <span class="o">+</span> <span class="mf">2.6494</span> <span class="o">*</span> <span class="n">D</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mf">10.2461</span> <span class="o">*</span> <span class="n">D</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mf">1.8002</span> <span class="o">*</span> <span class="n">D</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.1988</span> <span class="o">*</span> <span class="n">D</span> <span class="o">+</span> <span class="mf">0.0012</span><span class="p">)</span>
        <span class="n">eval_dict</span><span class="p">[</span><span class="s1">&#39;poly_sinkP3G&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2381</span><span class="o">*</span> <span class="n">D</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">0.0210</span> <span class="o">*</span> <span class="n">D</span> <span class="o">-</span><span class="mf">0.0034</span><span class="p">)</span>
        <span class="n">eval_dict</span><span class="p">[</span><span class="s1">&#39;poly_sinkPEP&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="o">-</span> <span class="mf">0.0637</span> <span class="o">*</span> <span class="n">D</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span>   <span class="mf">0.0617</span> <span class="o">*</span> <span class="n">D</span>   <span class="o">-</span>  <span class="mf">0.0008</span><span class="p">)</span>
        <span class="n">eval_dict</span><span class="p">[</span><span class="s1">&#39;poly_sinkPYR&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="o">-</span><span class="mf">8.4853e+03</span> <span class="o">*</span> <span class="n">D</span><span class="o">**</span><span class="mi">6</span> <span class="o">+</span> <span class="mf">9.4027e+03</span> <span class="o">*</span> <span class="n">D</span><span class="o">**</span><span class="mi">5</span> <span class="o">-</span> <span class="mf">3.8027e+03</span> <span class="o">*</span> <span class="n">D</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mf">700.5</span> <span class="o">*</span> <span class="n">D</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mf">60.26</span> <span class="o">*</span> <span class="n">D</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.711</span> <span class="o">*</span> <span class="n">D</span> <span class="o">-</span> <span class="mf">0.0356</span><span class="p">)</span>
        <span class="n">eval_dict</span><span class="p">[</span><span class="s1">&#39;poly_sinkACE&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mf">118.8562</span> <span class="o">*</span> <span class="n">D</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mf">352.3943</span> <span class="o">*</span> <span class="n">D</span><span class="o">**</span><span class="mi">5</span> <span class="o">+</span> <span class="mf">245.6092</span> <span class="o">*</span> <span class="n">D</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mf">75.2550</span> <span class="o">*</span> <span class="n">D</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mf">11.1153</span> <span class="o">*</span> <span class="n">D</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">1.0379</span> <span class="o">*</span> <span class="n">D</span> <span class="o">+</span> <span class="mf">0.0119</span><span class="p">)</span>


        <span class="c1">## calculate the expression given the dilution rate and update parameters</span>

        <span class="n">rate_vGLT</span><span class="o">=</span><span class="n">v_GLT</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_vHXK</span><span class="o">=</span><span class="n">v_HXK</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_vNTH1</span><span class="o">=</span><span class="n">v_NTH1</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_vPGI</span><span class="o">=</span><span class="n">v_PGI</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_vsinkG6P</span><span class="o">=</span><span class="n">v_sinkG6P</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>

        <span class="n">rate_vsinkF6P</span><span class="o">=</span><span class="n">v_sinkF6P</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_vPGM1</span><span class="o">=</span><span class="n">v_PGM1</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_vTPS1</span><span class="o">=</span><span class="n">v_TPS1</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_vTPS2</span><span class="o">=</span><span class="n">v_TPS2</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_vPFK</span><span class="o">=</span><span class="n">v_PFK</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>

        <span class="n">rate_vALD</span><span class="o">=</span><span class="n">v_ALD</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_TPI1</span><span class="o">=</span><span class="n">v_TPI1</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_GP3DH</span><span class="o">=</span><span class="n">v_G3PDH</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_PGK</span><span class="o">=</span><span class="n">v_PGK</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_vsinkGAP</span><span class="o">=</span><span class="n">v_sinkGAP</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>

        <span class="n">rate_GAPDH</span><span class="o">=</span><span class="n">v_GAPDH</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_vsink3PGA</span><span class="o">=</span><span class="n">vsink3PGA</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_HOR2</span><span class="o">=</span><span class="n">v_HOR2</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_vGLycT</span><span class="o">=</span><span class="n">v_GlycT</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_PGM</span><span class="o">=</span><span class="n">v_PGM</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>

        <span class="n">rate_ENO</span><span class="o">=</span><span class="n">v_ENO</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_vsinkPEP</span><span class="o">=</span><span class="n">vsinkPEP</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_PYK1</span><span class="o">=</span><span class="n">v_PYK1</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_vsinkPYR</span><span class="o">=</span><span class="n">vsinkPYR</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_vPDC</span><span class="o">=</span><span class="n">v_PDC</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>

        <span class="n">rate_ADH</span><span class="o">=</span><span class="n">v_ADH</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_vsinkACE</span><span class="o">=</span><span class="n">vsinkACE</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_ETOH_transport</span><span class="o">=</span><span class="n">v_EtohT</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_vmitoNADH</span><span class="o">=</span><span class="n">v_mitoNADH</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_ATPmito</span><span class="o">=</span><span class="n">v_ATPmito</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>

        <span class="n">rate_ATPase</span><span class="o">=</span><span class="n">v_ATPase</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_ADK1</span><span class="o">=</span><span class="n">v_ADK</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_VacPi</span><span class="o">=</span><span class="n">v_VacPi</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_AMD1</span><span class="o">=</span><span class="n">v_AMD1</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_ADE1312</span><span class="o">=</span><span class="n">v_ADE1312</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>

        <span class="n">rate_ISN1</span><span class="o">=</span><span class="n">v_ISN1</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_PNP1</span><span class="o">=</span><span class="n">v_PNP1</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
        <span class="n">rate_HPT1</span><span class="o">=</span><span class="n">v_HPT1</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>



        <span class="n">dG1P</span><span class="o">=-</span><span class="n">rate_vPGM1</span><span class="o">-</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;flux_ugp&#39;</span><span class="p">]</span>
        <span class="n">dT6P</span><span class="o">=+</span><span class="n">rate_vTPS1</span> <span class="o">-</span><span class="n">rate_vTPS2</span>
        <span class="n">dICTRE</span><span class="o">=+</span><span class="n">rate_vTPS2</span> <span class="o">-</span><span class="n">rate_vNTH1</span>


        <span class="n">dICglci</span><span class="o">=+</span><span class="n">rate_vGLT</span> <span class="o">-</span> <span class="n">rate_vHXK</span> <span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">rate_vNTH1</span>

        <span class="n">dICG6P</span><span class="o">=+</span><span class="n">rate_vHXK</span><span class="o">-</span><span class="n">rate_vPGI</span> <span class="o">-</span><span class="n">rate_vsinkG6P</span> <span class="o">+</span><span class="n">rate_vPGM1</span><span class="o">-</span><span class="n">rate_vTPS1</span>
        <span class="n">dICF6P</span><span class="o">=+</span><span class="n">rate_vPGI</span> <span class="o">+</span><span class="n">rate_vsinkF6P</span><span class="o">-</span><span class="n">rate_vPFK</span>
        <span class="n">dICFBP</span><span class="o">=+</span><span class="n">rate_vPFK</span> <span class="o">-</span><span class="n">rate_vALD</span>

        <span class="n">dICDHAP</span><span class="o">=+</span><span class="n">rate_vALD</span> <span class="o">-</span> <span class="n">rate_TPI1</span> <span class="o">-</span> <span class="n">rate_GP3DH</span>
        <span class="n">dICG3P</span><span class="o">=+</span><span class="n">rate_GP3DH</span><span class="o">-</span><span class="n">rate_HOR2</span>
        <span class="n">dICGlyc</span><span class="o">=+</span><span class="n">rate_HOR2</span><span class="o">-</span><span class="n">rate_vGLycT</span>

        <span class="n">dICGAP</span><span class="o">=+</span><span class="n">rate_vALD</span> <span class="o">+</span><span class="n">rate_TPI1</span>  <span class="o">-</span><span class="n">rate_GAPDH</span> <span class="o">+</span><span class="n">rate_vsinkGAP</span>
        <span class="n">dICBPG</span><span class="o">=+</span><span class="n">rate_GAPDH</span> <span class="o">-</span><span class="n">rate_PGK</span>
        <span class="n">dIC3PG</span><span class="o">=+</span><span class="n">rate_PGK</span> <span class="o">-</span> <span class="n">rate_vsink3PGA</span> <span class="o">-</span><span class="n">rate_PGM</span>
        <span class="n">dIC2PG</span><span class="o">=+</span><span class="n">rate_PGM</span><span class="o">-</span><span class="n">rate_ENO</span>

        <span class="n">dICPEP</span><span class="o">=+</span><span class="n">rate_ENO</span> <span class="o">-</span><span class="n">rate_vsinkPEP</span><span class="o">-</span><span class="n">rate_PYK1</span> 

        <span class="n">dICPYR</span><span class="o">=</span> <span class="o">+</span><span class="n">rate_PYK1</span> <span class="o">-</span><span class="n">rate_vPDC</span> <span class="o">-</span><span class="n">rate_vsinkPYR</span> 

        <span class="n">dICACE</span><span class="o">=</span> <span class="o">+</span><span class="n">rate_vPDC</span> <span class="o">-</span><span class="n">rate_ADH</span> <span class="o">-</span><span class="n">rate_vsinkACE</span>

        <span class="n">dICETOH</span><span class="o">=+</span><span class="n">rate_ADH</span> <span class="o">-</span><span class="n">rate_ETOH_transport</span>



        <span class="n">dICNAD</span><span class="o">=+</span><span class="n">rate_GP3DH</span> <span class="o">-</span><span class="n">rate_GAPDH</span>   <span class="o">+</span><span class="n">rate_ADH</span> <span class="o">+</span><span class="n">rate_vmitoNADH</span> 
        <span class="n">dICNADH</span><span class="o">=-</span><span class="n">rate_GP3DH</span> <span class="o">+</span><span class="n">rate_GAPDH</span>   <span class="o">-</span><span class="n">rate_ADH</span> <span class="o">-</span><span class="n">rate_vmitoNADH</span>
        <span class="n">dATP</span><span class="o">=+</span><span class="n">rate_ADK1</span><span class="o">-</span><span class="n">rate_vHXK</span> <span class="o">-</span><span class="n">rate_ATPase</span> <span class="o">-</span><span class="n">rate_vPFK</span> <span class="o">+</span> <span class="n">rate_PGK</span> <span class="o">+</span><span class="n">rate_PYK1</span> <span class="o">-</span><span class="n">rate_vTPS1</span> <span class="o">+</span><span class="n">rate_ATPmito</span>
        <span class="n">dADP</span><span class="o">=-</span><span class="mi">2</span><span class="o">*</span><span class="n">rate_ADK1</span><span class="o">+</span><span class="n">rate_vHXK</span> <span class="o">+</span><span class="n">rate_ATPase</span> <span class="o">+</span><span class="n">rate_vPFK</span> <span class="o">-</span><span class="n">rate_PGK</span> <span class="o">-</span> <span class="n">rate_PYK1</span> <span class="o">+</span><span class="n">rate_vTPS2</span> <span class="o">-</span><span class="n">rate_ATPmito</span>
        <span class="n">dAMP</span><span class="o">=+</span><span class="n">rate_ADK1</span>  <span class="o">-</span><span class="n">rate_AMD1</span> <span class="o">+</span><span class="n">rate_ADE1312</span>

        <span class="n">dPHOS</span><span class="o">=-</span><span class="n">rate_GAPDH</span> <span class="o">+</span><span class="n">rate_ATPase</span> <span class="o">+</span><span class="n">rate_HOR2</span> <span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">rate_vTPS1</span> <span class="o">+</span><span class="n">rate_vTPS2</span> <span class="o">-</span><span class="n">rate_ATPmito</span> <span class="o">+</span><span class="n">rate_ISN1</span><span class="o">-</span><span class="n">rate_PNP1</span> <span class="o">+</span><span class="n">rate_VacPi</span> <span class="o">+</span><span class="n">rate_vsinkG6P</span> <span class="o">-</span><span class="n">rate_vsinkF6P</span> <span class="o">+</span><span class="n">rate_vsink3PGA</span> <span class="o">+</span><span class="n">rate_vsinkPEP</span><span class="o">-</span><span class="n">rate_vsinkGAP</span>
        <span class="n">dIMP</span><span class="o">=</span><span class="n">rate_AMD1</span><span class="o">-</span><span class="n">rate_ADE1312</span><span class="o">+</span><span class="n">rate_HPT1</span><span class="o">-</span><span class="n">rate_ISN1</span>
        <span class="n">dINO</span><span class="o">=</span><span class="n">rate_ISN1</span><span class="o">-</span><span class="n">rate_PNP1</span>
        <span class="n">dHYP</span><span class="o">=+</span><span class="n">rate_PNP1</span> <span class="o">-</span><span class="n">rate_HPT1</span>

        <span class="c1">##!! </span>
        <span class="n">dECETOH</span><span class="o">=+</span><span class="n">rate_ETOH_transport</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ECbiomass</span><span class="o">*</span><span class="mf">0.002</span> <span class="o">-</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="s1">&#39;ECETOH&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">3600</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dilution_rate</span> <span class="c1">#ethanol production</span>
        <span class="n">dECglyc</span><span class="o">=+</span><span class="n">rate_vGLycT</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ECbiomass</span><span class="o">*</span><span class="mf">0.002</span> <span class="o">-</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="s1">&#39;ECETOH&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">3600</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dilution_rate</span> <span class="c1">#glycerol </span>
        <span class="c1">##!!  </span>

        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">dG1P</span><span class="p">,</span><span class="n">dT6P</span><span class="p">,</span><span class="n">dICTRE</span><span class="p">,</span><span class="n">dICglci</span><span class="p">,</span><span class="n">dICG6P</span><span class="p">,</span><span class="n">dICF6P</span><span class="p">,</span>
                          <span class="n">dICFBP</span><span class="p">,</span><span class="n">dICDHAP</span><span class="p">,</span><span class="n">dICG3P</span><span class="p">,</span>
                          <span class="n">dICGlyc</span><span class="p">,</span><span class="n">dICGAP</span><span class="p">,</span><span class="n">dICBPG</span><span class="p">,</span><span class="n">dIC3PG</span><span class="p">,</span>
                          <span class="n">dIC2PG</span><span class="p">,</span><span class="n">dICPEP</span><span class="p">,</span><span class="n">dICPYR</span><span class="p">,</span><span class="n">dICACE</span><span class="p">,</span><span class="n">dICETOH</span><span class="p">,</span><span class="n">dECETOH</span><span class="p">,</span><span class="n">dECglyc</span><span class="p">,</span><span class="n">dICNADH</span><span class="p">,</span>
                          <span class="n">dICNAD</span><span class="p">,</span><span class="n">dATP</span><span class="p">,</span><span class="n">dADP</span><span class="p">,</span><span class="n">dAMP</span><span class="p">,</span><span class="n">dPHOS</span><span class="p">,</span><span class="n">dIMP</span><span class="p">,</span><span class="n">dINO</span><span class="p">,</span><span class="n">dHYP</span><span class="p">])</span><span class="c1">#,dICPEP,dICPYR,dICACE])</span>
</code></pre></div>

<h4 id="parameterization">Parameterization</h4>
<p>For a script that parameterizes this model, we refer to the training scripts in <a href="https://github.com/AbeelLab/jaxkineticmodel/blob/main/scripts/experiments/1709_train_gp_onedataset.py">scripts/experiments/</a>, or you can use the object-oriented training process as described in <a href="../training_models/">Training models</a></p>
<h3 id="references">References</h3>
<p>[1] Lao-Martil, D., Schmitz, J. P., Teusink, B., &amp; van Riel, N. A. (2023). Elucidating yeast glycolytic dynamics at steady state growth and glucose pulses through kinetic metabolic modeling. Metabolic engineering, 77, 128-142.
[2] Arxiv reference</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../simulated-DBTL/" class="btn btn-neutral float-left" title="Simulated-DBTL"><span class="icon icon-circle-arrow-left"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../simulated-DBTL/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
